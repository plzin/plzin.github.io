{"pageProps":{"postData":{"title":"Mixed Boolean-Arithmetic (Part 4): Deobfuscation","date":"2023-04-24","macros":[{"b":"\\mathbf{b}"},{"v":"\\mathbf{v}"},{"x":"\\mathbf{x}"},{"Z":"\\mathbb{Z}"}],"id":"mba-deobf","contentHtml":"<p>You should read <a href=\"/posts/mba\">Part 1</a>, before coming here, but reading <a href=\"/posts/linear-systems-mod-n\">Part 2</a>\nis not required.\nIf you encounter permutation polynomials then you should probably read <a href=\"/posts/perm-poly\">Part 3</a>\nwhich should be enough to figure out how to deobfuscate them.\nWe will be focusing on linear MBA.\nI will update this post to talk about non-linear MBA at some point,\nbut generally it is very difficult and I know of no better way\nthan trying to invert the techniques for generating non-linear MBA.</p>\n<p>Deobfuscation is either easy or hard, depending on what your goal is.\nAs always it is not easy to define what a \"simplified\" or simple expression even is.\nIn particular simplifying MBA expressions includes simplifying boolean expressions.\nIt is known that the\n<a href=\"https://en.wikipedia.org/wiki/Logic_optimization#Boolean_expression_minimization\">minimization of boolean expressions</a>\nis <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msubsup><mjx-mi class=\"mjx-n\"><mjx-c class=\"mjx-c3A3\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.288em; margin-left: 0;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D443 TEX-I\"></mjx-c></mjx-mi><mjx-spacer style=\"margin-top: 0.18em;\"></mjx-spacer><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msubsup></mjx-math></mjx-container><a href=\"https://en.wikipedia.org/wiki/Polynomial_hierarchy\">-complete</a>,\nwhich is (probably, but not proven to be) \"worse\" than <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ss\"><mjx-c class=\"mjx-c1D5AD TEX-SS\"></mjx-c><mjx-c class=\"mjx-c1D5AF TEX-SS\"></mjx-c></mjx-mi></mjx-texatom></mjx-math></mjx-container>-complete but (probably) \"better\" than <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ss\"><mjx-c class=\"mjx-c1D5AF TEX-SS\"></mjx-c><mjx-c class=\"mjx-c1D5B2 TEX-SS\"></mjx-c><mjx-c class=\"mjx-c1D5AF TEX-SS\"></mjx-c><mjx-c class=\"mjx-c1D5A0 TEX-SS\"></mjx-c><mjx-c class=\"mjx-c1D5A2 TEX-SS\"></mjx-c><mjx-c class=\"mjx-c1D5A4 TEX-SS\"></mjx-c></mjx-mi></mjx-texatom></mjx-math></mjx-container>-complete.\nFrom that standpoint we are lost, but from a more practical standpoint it does not look so bad.\nNote that the techniques discussed here can only help to deobfuscate MBA expressions of the kind\nthat the techniques in the other parts can generate.\nAs far as I know though, these are the only kinds of expressions\nthat anyone knows how to generate efficiently.</p>\n<h1>What is the Problem?</h1>\n<p>The input to our algorithm is an MBA circuit.\nFor our purposes this just means an MBA expression where common subexpressions can be shared,\nor in other words, a part of a program that computes an MBA expression.\nThe output will be a (hopefully simpler) MBA circuit that computes the same function.\nObviously it will not always be possible to find a simpler expression.\nIf the input is <code>x+y</code>, the output will be the same.\nFinding a minimal expression is not generally feasible for the complexity theoretic reasons outlined in the beginning.</p>\n<h1>Approach</h1>\n<p>The approach is similar to a lot of deobfuscation.</p>\n<ul>\n<li>Identify part of the program that has a form you can work with.</li>\n<li>Try to simplify it.</li>\n<li>Start over, until nothing changes or there are no more parts you can simplify.</li>\n</ul>\n<p>The obfuscation algorithm starts with a linear MBA expression and transforms it into a more complicated but equivalent one.\nIf you knew, that some function/expression/circuit computed a linear MBA expression,\nthen you could deobfuscate it as a black box.\nOne difficulty is verifying that some circuit computes a linear MBA expression, even if it contains (say) polynomials.\nSo the first step of the general approach is to find some subexpression that is a linear MBA expression or a polynomial.\nWe will now discuss simplifying both of these.</p>\n<h1>Linear MBA</h1>\n<p>Simplifying linear MBA is the more difficult problem.\nLet us consider the toy problem from Part 1 again and try to simplify <code>2 * (x &#x26; y) + (x ^ y)</code>.\nAs we've seen there, this is equivalent to <code>x + y</code>.\nIn Part 1 the problem was generating expressions like the former automatically,\nwhile we now have to do the reverse.\nThe idea is very similar, so let's quickly discuss the former problem in more detail.\nWe are given an expression which is a linear combination of boolean expressions, or in other words, a linear MBA expression,\nand a list of rewrite operations, which can be linear MBA expressions as well.\nThe output will then be a random linear combination of the rewrite operations that is equivalent to the input expression.\nThis time around, the input expression is the obfuscated one, and we don't have a list of rewrite operations,\nand we don't want a random linear combination, but a particularly simple one.\nIf the obfuscated expression was generated using the same algorithm, we'd ideally want the input expression.\nSo we are now facing two problems:</p>\n<ul>\n<li>Find a list of rewrite operations</li>\n<li>Find the \"smallest\" solution</li>\n</ul>\n<p>Let's think through the example.\nThe input expression is the obfuscated expression <code>2 * (x &#x26; y) + (x ^ y)</code>.\nBecause we know the solution, we know that the rewrite operations <code>x</code>, <code>y</code> (i.e. the identity on x and y) are sufficient.\nWe will use these for now.\nAs in Part 1, these expressions are specific to a certain integer width, although this one in specific works for any width.\nWe will just use 8-bit integers and the following notation from Part 1.\n<mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\" display=\"true\"><mjx-math display=\"true\" style=\"margin-left: 0; margin-right: 0;\" class=\"MJX-TEX\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D453 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo><mjx-texatom space=\"4\" texclass=\"REL\"><mjx-mpadded><mjx-block style=\"width: 0.198em; margin: 0.04em 0 0; position: relative;\"><mjx-rbox style=\"left: -0.04em; top: -0.04em; max-width: 0.198em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c3A\"></mjx-c></mjx-mo></mjx-rbox></mjx-block></mjx-mpadded><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo></mjx-texatom><mjx-mrow space=\"4\"><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 5.2em; vertical-align: -2.35em;\" class=\"mjx-c5B\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=\"min-width: 2.773em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-bottom: 0.2em;\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D453 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D453 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D453 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em;\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D453 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 5.2em; vertical-align: -2.35em;\" class=\"mjx-c5D\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow></mjx-math></mjx-container>\nThe system then looks like this.\n<mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\" display=\"true\"><mjx-math display=\"true\" style=\"margin-left: 0; margin-right: 0;\" class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D450 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D450 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c22C5\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2227\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2295\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo><mjx-mspace style=\"width: 1em;\"></mjx-mspace><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-n\"><mjx-c class=\"mjx-c6D\"></mjx-c><mjx-c class=\"mjx-c6F\"></mjx-c><mjx-c class=\"mjx-c64\"></mjx-c></mjx-mi><mjx-mspace style=\"width: 0.333em;\"></mjx-mspace><mjx-msup space=\"2\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.413em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c38\"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo></mjx-math></mjx-container>\nThis expands to\n<mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\" display=\"true\"><mjx-math display=\"true\" style=\"margin-left: 0; margin-right: 0;\" class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D450 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mrow space=\"2\"><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 5.2em; vertical-align: -2.35em;\" class=\"mjx-c5B\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=\"min-width: 0.5em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 5.2em; vertical-align: -2.35em;\" class=\"mjx-c5D\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D450 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mrow space=\"2\"><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 5.2em; vertical-align: -2.35em;\" class=\"mjx-c5B\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=\"min-width: 0.5em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 5.2em; vertical-align: -2.35em;\" class=\"mjx-c5D\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mrow space=\"4\"><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 5.2em; vertical-align: -2.35em;\" class=\"mjx-c5B\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=\"min-width: 2em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-right: 0.5em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-right: 0.5em; padding-top: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em; padding-top: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 5.2em; vertical-align: -2.35em;\" class=\"mjx-c5D\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mrow space=\"2\"><mjx-mo class=\"mjx-s3\"><mjx-c class=\"mjx-c5B TEX-S3\"></mjx-c></mjx-mo><mjx-mtable style=\"min-width: 0.87em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-bottom: 0.2em;\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D450 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em;\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D450 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-s3\"><mjx-c class=\"mjx-c5D TEX-S3\"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mrow space=\"4\"><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 5.2em; vertical-align: -2.35em;\" class=\"mjx-c5B\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=\"min-width: 0.5em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 5.2em; vertical-align: -2.35em;\" class=\"mjx-c5D\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mspace style=\"width: 1em;\"></mjx-mspace><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-n\"><mjx-c class=\"mjx-c6D\"></mjx-c><mjx-c class=\"mjx-c6F\"></mjx-c><mjx-c class=\"mjx-c64\"></mjx-c></mjx-mi><mjx-mspace style=\"width: 0.333em;\"></mjx-mspace><mjx-msup space=\"2\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.413em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c38\"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo></mjx-math></mjx-container>\nIt is relatively easy to see that <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D450 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-msub space=\"4\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D450 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-math></mjx-container> is the only solution (even mod 256).\nThis means <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container> would be the deobfuscated expression.</p>\n<p>There are two problems:</p>\n<ul>\n<li>We had to look at the simplified expression to determine the rewrite operations.</li>\n<li>We were lucky that there was only one solution.</li>\n</ul>\n<p>Before we discuss how to choose rewrite operations more generally,\nwe will consider the same example with the slightly bigger set of rewrite operations:\n<code>x</code>, <code>y</code>, <code>~x</code>, <code>~y</code>, <code>1</code>.\nThe solutions to the resulting system have the following form\n<mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\" display=\"true\"><mjx-math display=\"true\" style=\"margin-left: 0; margin-right: 0;\" class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D41C TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mrow space=\"4\"><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 6.6em; vertical-align: -3.05em;\" class=\"mjx-c5B\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=\"min-width: 2.278em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-bottom: 0.2em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c39\"></mjx-c><mjx-c class=\"mjx-c33\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c33\"></mjx-c><mjx-c class=\"mjx-c38\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c39\"></mjx-c><mjx-c class=\"mjx-c34\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c33\"></mjx-c><mjx-c class=\"mjx-c39\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c33\"></mjx-c><mjx-c class=\"mjx-c33\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 6.6em; vertical-align: -3.05em;\" class=\"mjx-c5D\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mrow space=\"2\"><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 6.6em; vertical-align: -3.05em;\" class=\"mjx-c5B\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=\"min-width: 1.778em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-bottom: 0.2em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c39\"></mjx-c><mjx-c class=\"mjx-c37\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c37\"></mjx-c><mjx-c class=\"mjx-c35\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c39\"></mjx-c><mjx-c class=\"mjx-c37\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c37\"></mjx-c><mjx-c class=\"mjx-c35\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 6.6em; vertical-align: -3.05em;\" class=\"mjx-c5D\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mrow space=\"2\"><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 6.6em; vertical-align: -3.05em;\" class=\"mjx-c5B\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=\"min-width: 2.278em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-bottom: 0.2em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c30\"></mjx-c><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c33\"></mjx-c><mjx-c class=\"mjx-c38\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c30\"></mjx-c><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c33\"></mjx-c><mjx-c class=\"mjx-c38\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c37\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 6.6em; vertical-align: -3.05em;\" class=\"mjx-c5D\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow></mjx-math></mjx-container>\nNow we have many solutions, e.g. <code>-93*x - 38*y - 94*~x - 39*~y - 133</code>.\nSince we are concerned with deobfuscation, this is not good enough,\nwe want the \"smallest\" solution.\nThe following describes the same set of solutions, where the solution <code>x + y</code> can easily be read of.\n<mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\" display=\"true\"><mjx-math display=\"true\" style=\"margin-left: 0; margin-right: 0;\" class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D41C TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mrow space=\"4\"><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 6.6em; vertical-align: -3.05em;\" class=\"mjx-c5B\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=\"min-width: 0.5em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 6.6em; vertical-align: -3.05em;\" class=\"mjx-c5D\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mrow space=\"2\"><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 6.6em; vertical-align: -3.05em;\" class=\"mjx-c5B\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=\"min-width: 1.278em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-bottom: 0.2em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 6.6em; vertical-align: -3.05em;\" class=\"mjx-c5D\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mrow space=\"2\"><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 6.6em; vertical-align: -3.05em;\" class=\"mjx-c5B\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=\"min-width: 1.278em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-bottom: 0.2em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 6.6em; vertical-align: -3.05em;\" class=\"mjx-c5D\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow></mjx-math></mjx-container></p>\n<p>We will now consider these two problems in more detail.</p>\n<h3>Rewrite operations</h3>\n<p>Suppose the MBA expression is just a boolean expression.\nThe best rewrite operation is the minimal boolean formula,\nwhich is (as discussed in the introduction) very unlikely to have a polynomial time algorithm.\nSo theoretically there is no good solution here.\nPractically things aren't looking so bad.\nUsually the input expressions to obfuscate are either purely arithmetic\nor purely boolean.</p>\n<p>If it is purely boolean, that is easy to tell, by evaluating it at 0, -1 inputs.\nIf the outputs are also only 0 or -1, then the function is expressible by a boolean expression.\nIn that case, you can try to find a minimal boolean formula using the truth table we just computed.</p>\n<p>Being purely arithmetic in this context means being a linear combination of the variables and a constant.\nIn that case the rewrite operations can just be the variables (the identity function on the variables)\nand -1 (or also 1 as the rewrite operations can be linear combinations of bitwise operations).</p>\n<p>The difficult (and probably less common) case is when the input function can only be represented\nas a linear combination of (non-trivial) boolean functions.\nTo ensure the linear system has a solution, we can always use the boolean expressions in the input.\nThinking practically again, the boolean operations in the non-obfuscated expression\nwere probably simple as well, so it might be worth it to use <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-n\"><mjx-c class=\"mjx-cAC\"></mjx-c></mjx-mi><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D463 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math></mjx-container>, <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D463 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2227\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D463 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math></mjx-container>, <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D463 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2228\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D463 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math></mjx-container>\n(etc.) for all variables <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D463 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-msub space=\"2\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D463 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math></mjx-container>.\nNote that the number of such rewrite operations will grow quickly with the number of variables,\nso this might not always be feasible.</p>\n<h3>Small solution</h3>\n<p>Now that we chose the rewrite operations, we can set up the system of linear congruences and solve it.\nThis gives us a particular solution <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D431 TEX-B\"></mjx-c></mjx-mi></mjx-texatom></mjx-math></mjx-container> and a basis for the kernel <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D41B TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c2026\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-msub space=\"2\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D41B TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>.\nAll solutions are then of the form <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D431 TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D41B TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c22EF\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-msub><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D41B TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>.\nI will call the set of solutions <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D446 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c7B\"></mjx-c></mjx-mo><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D431 TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D41B TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c22EF\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-msub><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D41B TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mtext class=\"mjx-n\"><mjx-c class=\"mjx-cA0\"></mjx-c></mjx-mtext><mjx-texatom texclass=\"ORD\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c7C\"></mjx-c></mjx-mo></mjx-texatom><mjx-mtext class=\"mjx-n\"><mjx-c class=\"mjx-cA0\"></mjx-c></mjx-mtext><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c2026\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-msub space=\"2\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c2208\"></mjx-c></mjx-mo><mjx-msub space=\"4\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c2124 TEX-A\"></mjx-c></mjx-mi></mjx-texatom><mjx-script style=\"vertical-align: -0.15em;\"><mjx-texatom size=\"s\" texclass=\"ORD\"><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.289em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D464 TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c7D\"></mjx-c></mjx-mo></mjx-math></mjx-container>\nan affine, modular <a href=\"https://en.wikipedia.org/wiki/Lattice_(group)\">lattice</a>.\n'Affine', since the origin is not necessarily in <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D446 TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container>, in reference to affine space.\n(You could also call it a coset of a lattice).\n'Modular', because everything is in the integers modulo <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D464 TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container>.</p>\n<p>We will discuss what it even means to be a small solution in a bit,\nbut I wanna explain the idea of how to solve it first.\nThe idea is to reduce it to a well known algorithmic problem, the\n<a href=\"https://en.wikipedia.org/wiki/Lattice_problem#Closest_vector_problem_(CVP)\">closest vector problem</a>,\ni. e. given a basis for a lattice and a point,\nfind the/a point on the lattice that is closest to the point according to the <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c2113\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-math></mjx-container> norm.\nIf we solve the closest vector problem for <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D41B TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c2026\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-msub space=\"2\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D41B TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container> and <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D431 TEX-B\"></mjx-c></mjx-mi></mjx-texatom></mjx-math></mjx-container>,\nthen we find a vector <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D42F TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-sop\" space=\"4\"><mjx-c class=\"mjx-c2211 TEX-S1\"></mjx-c></mjx-mo><mjx-msub space=\"2\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D456 TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-msub><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D41B TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D456 TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>, such that <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2016\"></mjx-c></mjx-mo><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D431 TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-texatom space=\"3\" texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D42F TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2016\"></mjx-c></mjx-mo></mjx-math></mjx-container> is minimal,\nbut <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D431 TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-texatom space=\"3\" texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D42F TEX-B\"></mjx-c></mjx-mi></mjx-texatom></mjx-math></mjx-container> is a point on the affine lattice,\nso we found the smallest point on the affine lattice.\nBut there is a catch!\nLet's disregard the affine part (i. e. the <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D431 TEX-B\"></mjx-c></mjx-mi></mjx-texatom></mjx-math></mjx-container>).\nWhat I called lattice above isn't really a lattice by most definitions because everything is mod <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D464 TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container>\nand the algorithms for the closest vector problem need lattices in <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c211D TEX-A\"></mjx-c></mjx-mi></mjx-texatom><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container> (or <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c2124 TEX-A\"></mjx-c></mjx-mi></mjx-texatom><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container>).\nThere is of course a very natural way in which the modular lattice is also an actual lattice.\nThe basic idea is to look at the origin of <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msubsup><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c2124 TEX-A\"></mjx-c></mjx-mi></mjx-texatom><mjx-script style=\"vertical-align: -0.296em; margin-left: 0;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi><mjx-spacer style=\"margin-top: 0.18em;\"></mjx-spacer><mjx-texatom size=\"s\" texclass=\"ORD\"><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.289em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D464 TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-texatom></mjx-script></mjx-msubsup></mjx-math></mjx-container> and extend that pattern to all of <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c2124 TEX-A\"></mjx-c></mjx-mi></mjx-texatom><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container>.\nYou might think that you can just take the basis vectors and and let them be the basis for the lattice,\nbut that doesn't work.\n(It isn't even really well defined because you have to choose representatives.)\nSuppose that we are in the one dimensional (think number line) lattice spanned by 3.\nThe lattice in <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c2124 TEX-A\"></mjx-c></mjx-mi></mjx-texatom></mjx-math></mjx-container> with basis 3 is just all multiples of 3, but mod (say) <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c34\"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-math></mjx-container>,\nit contains all numbers 0 to 15, so the natural generalization to <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c2124 TEX-A\"></mjx-c></mjx-mi></mjx-texatom></mjx-math></mjx-container> should also be the whole of <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c2124 TEX-A\"></mjx-c></mjx-mi></mjx-texatom></mjx-math></mjx-container>.\nWe need to be able to add multiples of 16.\nSo we can instead consider the lattice with the generating set 3, 16 in the integers\nand this is indeed all of <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c2124 TEX-A\"></mjx-c></mjx-mi></mjx-texatom></mjx-math></mjx-container>.\nOf course, this is no longer a basis because they are linearly dependent.\nIn general we consider the lattice generated by <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D41B TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c2026\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-msub space=\"2\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D41B TEX-B\"></mjx-c></mjx-mi></mjx-texatom><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-msup space=\"2\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D464 TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D452 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c2026\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-msup space=\"2\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D464 TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D452 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>,\nwhere the <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D452 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D456 TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container> is the vector with a 1 in the i-th position and 0s everywhere else.\nA priori, it is not even clear that this is a lattice and we still need a basis.\nWe can obtain a basis (and thus also a proof that this is in fact a lattice)\nby computing the <a href=\"https://en.wikipedia.org/wiki/Hermite_normal_form\">HNF</a>\nof the matrix with the columns being the generators.</p>\n<p>It might seem obvious what a small solution is,\nbut there are some subtleties to it.\nLet's consider the modular lattice from before,\nfor example assume 8-bit integers: Which solution is smaller: <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo></mjx-math></mjx-container> or <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c32\"></mjx-c><mjx-c class=\"mjx-c35\"></mjx-c><mjx-c class=\"mjx-c35\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo></mjx-math></mjx-container>?\nSince <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c><mjx-c class=\"mjx-c35\"></mjx-c><mjx-c class=\"mjx-c35\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c2261\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-mspace style=\"width: 0.444em;\"></mjx-mspace><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-n\"><mjx-c class=\"mjx-c6D\"></mjx-c><mjx-c class=\"mjx-c6F\"></mjx-c><mjx-c class=\"mjx-c64\"></mjx-c></mjx-mi><mjx-mspace style=\"width: 0.333em;\"></mjx-mspace><mjx-msup space=\"2\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c38\"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo></mjx-math></mjx-container>, we would probably want the latter,\nand with the integer lattice, this is indeed what we get.\nPerhaps more importantly, do we want the <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c2113\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-math></mjx-container> norm?\nThe problem with the <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c2113\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-math></mjx-container> norm is that all entries are treated equally.\nBut they contain the coefficients of rewrite operations and these can have different complexity,\ne.g. <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container> is simpler than <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-n\"><mjx-c class=\"mjx-cAC\"></mjx-c></mjx-mi><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2227\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2228\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-cAC\"></mjx-c></mjx-mi><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D467 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo></mjx-math></mjx-container>.\nOne way to do this is to actually use a different norm that multiplies\neach entry by some measure of the operations complexity before taking the norm,\nbut usually algorithms assume the <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c2113\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-math></mjx-container> norm.\nBut we can just multiply each entry in each basis vector (and the <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-b\"><mjx-c class=\"mjx-c1D431 TEX-B\"></mjx-c></mjx-mi></mjx-texatom></mjx-math></mjx-container>) by its complexity\nand divide the result again.</p>\n<p>Okay, so we have a general method to solve the problem but what is its complexity.\nUnfortunately (or hopefully perhaps?) there is probably no polynomial time algorithm\nfor the Closest Vector Problem.\nThis (or related problems that can be reduced to it) are used for Lattice Based Cryptography.\nNevertheless, the instances in practice are probably rather short and solvable\ndespite the asymptotic complexity.\nI found that the algorithm I showed in Part 2 to solve linear congruences\nalready finds a small solution (and basis) in the small examples I tried.\nIn particular for the example problem in this post it returned the second\nsolution and I manually made it more complicated to illustrate the general problem.\nThe problem with that is that you can not weigh different rewrite operations by their complexity.</p>\n<h1>Conclusion</h1>\n<p>We have seen how to deobfuscate MBA expressions,\nbut the complexity of the algorithm is exponential in the number of variables\n(and thus also in the length of the expression),\nbut then again, obfuscating is as well.\nWe are constructing the same truth table in both cases.</p>\n<p>Once the truth table is constructed,\nwe can decide whether the expression is purely boolean,\nin which case the problem reduces to finding the simplest\nboolean formula for the given truth table.</p>\n<p>Otherwise we have to choose some sensible set of\nrewrite operations and solve the linear system.\nIf you just use the solution by the algorithm in Part 2,\nthis is all you have to do.\nYou can try this out <a href=\"https://plzin.github.io/mba-wasm/\">here</a>,\nwhich is meant for obfuscation, but if you disable the \"Random solution\"\ncheckbox, you will get the particular solution found by the algorithm.\nSo input the obfuscated expression at the top and choose the rewrite operations\nand generate the \"obfuscated expression\".\nOtherwise you get a lattice of solutions which\ncan be used to find the smallest one using standard algorithms\nwhich are exponential in the size of the basis of the lattice.</p>","style":"\nmjx-container[jax=\"CHTML\"] {\n  line-height: 0;\n}\n\nmjx-container [space=\"1\"] {\n  margin-left: .111em;\n}\n\nmjx-container [space=\"2\"] {\n  margin-left: .167em;\n}\n\nmjx-container [space=\"3\"] {\n  margin-left: .222em;\n}\n\nmjx-container [space=\"4\"] {\n  margin-left: .278em;\n}\n\nmjx-container [space=\"5\"] {\n  margin-left: .333em;\n}\n\nmjx-container [rspace=\"1\"] {\n  margin-right: .111em;\n}\n\nmjx-container [rspace=\"2\"] {\n  margin-right: .167em;\n}\n\nmjx-container [rspace=\"3\"] {\n  margin-right: .222em;\n}\n\nmjx-container [rspace=\"4\"] {\n  margin-right: .278em;\n}\n\nmjx-container [rspace=\"5\"] {\n  margin-right: .333em;\n}\n\nmjx-container [size=\"s\"] {\n  font-size: 70.7%;\n}\n\nmjx-container [size=\"ss\"] {\n  font-size: 50%;\n}\n\nmjx-container [size=\"Tn\"] {\n  font-size: 60%;\n}\n\nmjx-container [size=\"sm\"] {\n  font-size: 85%;\n}\n\nmjx-container [size=\"lg\"] {\n  font-size: 120%;\n}\n\nmjx-container [size=\"Lg\"] {\n  font-size: 144%;\n}\n\nmjx-container [size=\"LG\"] {\n  font-size: 173%;\n}\n\nmjx-container [size=\"hg\"] {\n  font-size: 207%;\n}\n\nmjx-container [size=\"HG\"] {\n  font-size: 249%;\n}\n\nmjx-container [width=\"full\"] {\n  width: 100%;\n}\n\nmjx-box {\n  display: inline-block;\n}\n\nmjx-block {\n  display: block;\n}\n\nmjx-itable {\n  display: inline-table;\n}\n\nmjx-row {\n  display: table-row;\n}\n\nmjx-row > * {\n  display: table-cell;\n}\n\nmjx-mtext {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-mstyle {\n  display: inline-block;\n}\n\nmjx-merror {\n  display: inline-block;\n  color: red;\n  background-color: yellow;\n}\n\nmjx-mphantom {\n  visibility: hidden;\n}\n\n_::-webkit-full-page-media, _:future, :root mjx-container {\n  will-change: opacity;\n}\n\nmjx-math {\n  display: inline-block;\n  text-align: left;\n  line-height: 0;\n  text-indent: 0;\n  font-style: normal;\n  font-weight: normal;\n  font-size: 100%;\n  font-size-adjust: none;\n  letter-spacing: normal;\n  border-collapse: collapse;\n  word-wrap: normal;\n  word-spacing: normal;\n  white-space: nowrap;\n  direction: ltr;\n  padding: 1px 0;\n}\n\nmjx-container[jax=\"CHTML\"][display=\"true\"] {\n  display: block;\n  text-align: center;\n  margin: 1em 0;\n}\n\nmjx-container[jax=\"CHTML\"][display=\"true\"][width=\"full\"] {\n  display: flex;\n}\n\nmjx-container[jax=\"CHTML\"][display=\"true\"] mjx-math {\n  padding: 0;\n}\n\nmjx-container[jax=\"CHTML\"][justify=\"left\"] {\n  text-align: left;\n}\n\nmjx-container[jax=\"CHTML\"][justify=\"right\"] {\n  text-align: right;\n}\n\nmjx-mo {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-stretchy-h {\n  display: inline-table;\n  width: 100%;\n}\n\nmjx-stretchy-h > * {\n  display: table-cell;\n  width: 0;\n}\n\nmjx-stretchy-h > * > mjx-c {\n  display: inline-block;\n  transform: scalex(1.0000001);\n}\n\nmjx-stretchy-h > * > mjx-c::before {\n  display: inline-block;\n  width: initial;\n}\n\nmjx-stretchy-h > mjx-ext {\n  /* IE */ overflow: hidden;\n  /* others */ overflow: clip visible;\n  width: 100%;\n}\n\nmjx-stretchy-h > mjx-ext > mjx-c::before {\n  transform: scalex(500);\n}\n\nmjx-stretchy-h > mjx-ext > mjx-c {\n  width: 0;\n}\n\nmjx-stretchy-h > mjx-beg > mjx-c {\n  margin-right: -.1em;\n}\n\nmjx-stretchy-h > mjx-end > mjx-c {\n  margin-left: -.1em;\n}\n\nmjx-stretchy-v {\n  display: inline-block;\n}\n\nmjx-stretchy-v > * {\n  display: block;\n}\n\nmjx-stretchy-v > mjx-beg {\n  height: 0;\n}\n\nmjx-stretchy-v > mjx-end > mjx-c {\n  display: block;\n}\n\nmjx-stretchy-v > * > mjx-c {\n  transform: scaley(1.0000001);\n  transform-origin: left center;\n  overflow: hidden;\n}\n\nmjx-stretchy-v > mjx-ext {\n  display: block;\n  height: 100%;\n  box-sizing: border-box;\n  border: 0px solid transparent;\n  /* IE */ overflow: hidden;\n  /* others */ overflow: visible clip;\n}\n\nmjx-stretchy-v > mjx-ext > mjx-c::before {\n  width: initial;\n  box-sizing: border-box;\n}\n\nmjx-stretchy-v > mjx-ext > mjx-c {\n  transform: scaleY(500) translateY(.075em);\n  overflow: visible;\n}\n\nmjx-mark {\n  display: inline-block;\n  height: 0px;\n}\n\nmjx-c {\n  display: inline-block;\n}\n\nmjx-utext {\n  display: inline-block;\n  padding: .75em 0 .2em 0;\n}\n\nmjx-mi {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-TeXAtom {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-mpadded {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-rbox {\n  display: inline-block;\n  position: relative;\n}\n\nmjx-mrow {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-mtable {\n  display: inline-block;\n  text-align: center;\n  vertical-align: .25em;\n  position: relative;\n  box-sizing: border-box;\n  border-spacing: 0;\n  border-collapse: collapse;\n}\n\nmjx-mstyle[size=\"s\"] mjx-mtable {\n  vertical-align: .354em;\n}\n\nmjx-labels {\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n\nmjx-table {\n  display: inline-block;\n  vertical-align: -.5ex;\n  box-sizing: border-box;\n}\n\nmjx-table > mjx-itable {\n  vertical-align: middle;\n  text-align: left;\n  box-sizing: border-box;\n}\n\nmjx-labels > mjx-itable {\n  position: absolute;\n  top: 0;\n}\n\nmjx-mtable[justify=\"left\"] {\n  text-align: left;\n}\n\nmjx-mtable[justify=\"right\"] {\n  text-align: right;\n}\n\nmjx-mtable[justify=\"left\"][side=\"left\"] {\n  padding-right: 0 ! important;\n}\n\nmjx-mtable[justify=\"left\"][side=\"right\"] {\n  padding-left: 0 ! important;\n}\n\nmjx-mtable[justify=\"right\"][side=\"left\"] {\n  padding-right: 0 ! important;\n}\n\nmjx-mtable[justify=\"right\"][side=\"right\"] {\n  padding-left: 0 ! important;\n}\n\nmjx-mtable[align] {\n  vertical-align: baseline;\n}\n\nmjx-mtable[align=\"top\"] > mjx-table {\n  vertical-align: top;\n}\n\nmjx-mtable[align=\"bottom\"] > mjx-table {\n  vertical-align: bottom;\n}\n\nmjx-mtable[side=\"right\"] mjx-labels {\n  min-width: 100%;\n}\n\nmjx-mtr {\n  display: table-row;\n  text-align: left;\n}\n\nmjx-mtr[rowalign=\"top\"] > mjx-mtd {\n  vertical-align: top;\n}\n\nmjx-mtr[rowalign=\"center\"] > mjx-mtd {\n  vertical-align: middle;\n}\n\nmjx-mtr[rowalign=\"bottom\"] > mjx-mtd {\n  vertical-align: bottom;\n}\n\nmjx-mtr[rowalign=\"baseline\"] > mjx-mtd {\n  vertical-align: baseline;\n}\n\nmjx-mtr[rowalign=\"axis\"] > mjx-mtd {\n  vertical-align: .25em;\n}\n\nmjx-mtd {\n  display: table-cell;\n  text-align: center;\n  padding: .215em .4em;\n}\n\nmjx-mtd:first-child {\n  padding-left: 0;\n}\n\nmjx-mtd:last-child {\n  padding-right: 0;\n}\n\nmjx-mtable > * > mjx-itable > *:first-child > mjx-mtd {\n  padding-top: 0;\n}\n\nmjx-mtable > * > mjx-itable > *:last-child > mjx-mtd {\n  padding-bottom: 0;\n}\n\nmjx-tstrut {\n  display: inline-block;\n  height: 1em;\n  vertical-align: -.25em;\n}\n\nmjx-labels[align=\"left\"] > mjx-mtr > mjx-mtd {\n  text-align: left;\n}\n\nmjx-labels[align=\"right\"] > mjx-mtr > mjx-mtd {\n  text-align: right;\n}\n\nmjx-mtd[extra] {\n  padding: 0;\n}\n\nmjx-mtd[rowalign=\"top\"] {\n  vertical-align: top;\n}\n\nmjx-mtd[rowalign=\"center\"] {\n  vertical-align: middle;\n}\n\nmjx-mtd[rowalign=\"bottom\"] {\n  vertical-align: bottom;\n}\n\nmjx-mtd[rowalign=\"baseline\"] {\n  vertical-align: baseline;\n}\n\nmjx-mtd[rowalign=\"axis\"] {\n  vertical-align: .25em;\n}\n\nmjx-mn {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-msub {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-mspace {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-msup {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-msubsup {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-script {\n  display: inline-block;\n  padding-right: .05em;\n  padding-left: .033em;\n}\n\nmjx-script > mjx-spacer {\n  display: block;\n}\n\nmjx-c::before {\n  display: block;\n  width: 0;\n}\n\n.MJX-TEX {\n  font-family: MJXZERO, MJXTEX;\n}\n\n.TEX-B {\n  font-family: MJXZERO, MJXTEX-B;\n}\n\n.TEX-I {\n  font-family: MJXZERO, MJXTEX-I;\n}\n\n.TEX-MI {\n  font-family: MJXZERO, MJXTEX-MI;\n}\n\n.TEX-BI {\n  font-family: MJXZERO, MJXTEX-BI;\n}\n\n.TEX-S1 {\n  font-family: MJXZERO, MJXTEX-S1;\n}\n\n.TEX-S2 {\n  font-family: MJXZERO, MJXTEX-S2;\n}\n\n.TEX-S3 {\n  font-family: MJXZERO, MJXTEX-S3;\n}\n\n.TEX-S4 {\n  font-family: MJXZERO, MJXTEX-S4;\n}\n\n.TEX-A {\n  font-family: MJXZERO, MJXTEX-A;\n}\n\n.TEX-C {\n  font-family: MJXZERO, MJXTEX-C;\n}\n\n.TEX-CB {\n  font-family: MJXZERO, MJXTEX-CB;\n}\n\n.TEX-FR {\n  font-family: MJXZERO, MJXTEX-FR;\n}\n\n.TEX-FRB {\n  font-family: MJXZERO, MJXTEX-FRB;\n}\n\n.TEX-SS {\n  font-family: MJXZERO, MJXTEX-SS;\n}\n\n.TEX-SSB {\n  font-family: MJXZERO, MJXTEX-SSB;\n}\n\n.TEX-SSI {\n  font-family: MJXZERO, MJXTEX-SSI;\n}\n\n.TEX-SC {\n  font-family: MJXZERO, MJXTEX-SC;\n}\n\n.TEX-T {\n  font-family: MJXZERO, MJXTEX-T;\n}\n\n.TEX-V {\n  font-family: MJXZERO, MJXTEX-V;\n}\n\n.TEX-VB {\n  font-family: MJXZERO, MJXTEX-VB;\n}\n\nmjx-stretchy-v mjx-c, mjx-stretchy-h mjx-c {\n  font-family: MJXZERO, MJXTEX-S1, MJXTEX-S4, MJXTEX, MJXTEX-A ! important;\n}\n\n@font-face /* 0 */ {\n  font-family: MJXZERO;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Zero.woff\") format(\"woff\");\n}\n\n@font-face /* 1 */ {\n  font-family: MJXTEX;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 2 */ {\n  font-family: MJXTEX-B;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff\") format(\"woff\");\n}\n\n@font-face /* 3 */ {\n  font-family: MJXTEX-I;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff\") format(\"woff\");\n}\n\n@font-face /* 4 */ {\n  font-family: MJXTEX-MI;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff\") format(\"woff\");\n}\n\n@font-face /* 5 */ {\n  font-family: MJXTEX-BI;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff\") format(\"woff\");\n}\n\n@font-face /* 6 */ {\n  font-family: MJXTEX-S1;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 7 */ {\n  font-family: MJXTEX-S2;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 8 */ {\n  font-family: MJXTEX-S3;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 9 */ {\n  font-family: MJXTEX-S4;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 10 */ {\n  font-family: MJXTEX-A;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 11 */ {\n  font-family: MJXTEX-C;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 12 */ {\n  font-family: MJXTEX-CB;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff\") format(\"woff\");\n}\n\n@font-face /* 13 */ {\n  font-family: MJXTEX-FR;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 14 */ {\n  font-family: MJXTEX-FRB;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff\") format(\"woff\");\n}\n\n@font-face /* 15 */ {\n  font-family: MJXTEX-SS;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 16 */ {\n  font-family: MJXTEX-SSB;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff\") format(\"woff\");\n}\n\n@font-face /* 17 */ {\n  font-family: MJXTEX-SSI;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff\") format(\"woff\");\n}\n\n@font-face /* 18 */ {\n  font-family: MJXTEX-SC;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 19 */ {\n  font-family: MJXTEX-T;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 20 */ {\n  font-family: MJXTEX-V;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 21 */ {\n  font-family: MJXTEX-VB;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff\") format(\"woff\");\n}\n\nmjx-stretchy-v.mjx-c5B mjx-beg mjx-c::before {\n  content: \"\\23A1\";\n  padding: 1.154em 0.667em 0.645em 0;\n}\n\nmjx-stretchy-v.mjx-c5B mjx-ext mjx-c::before {\n  content: \"\\23A2\";\n  width: 0.667em;\n}\n\nmjx-stretchy-v.mjx-c5B mjx-end mjx-c::before {\n  content: \"\\23A3\";\n  padding: 1.155em 0.667em 0.644em 0;\n}\n\nmjx-stretchy-v.mjx-c5B > mjx-end {\n  margin-top: -1.799em;\n}\n\nmjx-stretchy-v.mjx-c5B > mjx-ext {\n  border-top-width: 1.769em;\n  border-bottom-width: 1.769em;\n}\n\nmjx-stretchy-v.mjx-c5D mjx-beg mjx-c::before {\n  content: \"\\23A4\";\n  padding: 1.154em 0.667em 0.645em 0;\n}\n\nmjx-stretchy-v.mjx-c5D mjx-ext mjx-c::before {\n  content: \"\\23A5\";\n  width: 0.667em;\n}\n\nmjx-stretchy-v.mjx-c5D mjx-end mjx-c::before {\n  content: \"\\23A6\";\n  padding: 1.155em 0.667em 0.644em 0;\n}\n\nmjx-stretchy-v.mjx-c5D > mjx-end {\n  margin-top: -1.799em;\n}\n\nmjx-stretchy-v.mjx-c5D > mjx-ext {\n  border-top-width: 1.769em;\n  border-bottom-width: 1.769em;\n}\n\nmjx-c.mjx-c27E8::before {\n  padding: 0.75em 0.389em 0.25em 0;\n  content: \"\\27E8\";\n}\n\nmjx-c.mjx-c1D453.TEX-I::before {\n  padding: 0.705em 0.55em 0.205em 0;\n  content: \"f\";\n}\n\nmjx-c.mjx-c27E9::before {\n  padding: 0.75em 0.389em 0.25em 0;\n  content: \"\\27E9\";\n}\n\nmjx-c.mjx-c3A::before {\n  padding: 0.43em 0.278em 0 0;\n  content: \":\";\n}\n\nmjx-c.mjx-c3D::before {\n  padding: 0.583em 0.778em 0.082em 0;\n  content: \"=\";\n}\n\nmjx-c.mjx-c28::before {\n  padding: 0.75em 0.389em 0.25em 0;\n  content: \"(\";\n}\n\nmjx-c.mjx-c30::before {\n  padding: 0.666em 0.5em 0.022em 0;\n  content: \"0\";\n}\n\nmjx-c.mjx-c2C::before {\n  padding: 0.121em 0.278em 0.194em 0;\n  content: \",\";\n}\n\nmjx-c.mjx-c29::before {\n  padding: 0.75em 0.389em 0.25em 0;\n  content: \")\";\n}\n\nmjx-c.mjx-c31::before {\n  padding: 0.666em 0.5em 0 0;\n  content: \"1\";\n}\n\nmjx-c.mjx-c1D450.TEX-I::before {\n  padding: 0.442em 0.433em 0.011em 0;\n  content: \"c\";\n}\n\nmjx-c.mjx-c1D465.TEX-I::before {\n  padding: 0.442em 0.572em 0.011em 0;\n  content: \"x\";\n}\n\nmjx-c.mjx-c2B::before {\n  padding: 0.583em 0.778em 0.082em 0;\n  content: \"+\";\n}\n\nmjx-c.mjx-c32::before {\n  padding: 0.666em 0.5em 0 0;\n  content: \"2\";\n}\n\nmjx-c.mjx-c1D466.TEX-I::before {\n  padding: 0.442em 0.49em 0.205em 0;\n  content: \"y\";\n}\n\nmjx-c.mjx-c22C5::before {\n  padding: 0.31em 0.278em 0 0;\n  content: \"\\22C5\";\n}\n\nmjx-c.mjx-c2227::before {\n  padding: 0.598em 0.667em 0.022em 0;\n  content: \"\\2227\";\n}\n\nmjx-c.mjx-c2295::before {\n  padding: 0.583em 0.778em 0.083em 0;\n  content: \"\\2295\";\n}\n\nmjx-c.mjx-c6D::before {\n  padding: 0.442em 0.833em 0 0;\n  content: \"m\";\n}\n\nmjx-c.mjx-c6F::before {\n  padding: 0.448em 0.5em 0.01em 0;\n  content: \"o\";\n}\n\nmjx-c.mjx-c64::before {\n  padding: 0.694em 0.556em 0.011em 0;\n  content: \"d\";\n}\n\nmjx-c.mjx-c38::before {\n  padding: 0.666em 0.5em 0.022em 0;\n  content: \"8\";\n}\n\nmjx-c.mjx-c5B.TEX-S3::before {\n  padding: 1.45em 0.528em 0.949em 0;\n  content: \"[\";\n}\n\nmjx-c.mjx-c5D.TEX-S3::before {\n  padding: 1.45em 0.528em 0.949em 0;\n  content: \"]\";\n}\n\nmjx-c.mjx-c1D41C.TEX-B::before {\n  padding: 0.453em 0.511em 0.006em 0;\n  content: \"c\";\n}\n\nmjx-c.mjx-c2212::before {\n  padding: 0.583em 0.778em 0.082em 0;\n  content: \"\\2212\";\n}\n\nmjx-c.mjx-c39::before {\n  padding: 0.666em 0.5em 0.022em 0;\n  content: \"9\";\n}\n\nmjx-c.mjx-c33::before {\n  padding: 0.665em 0.5em 0.022em 0;\n  content: \"3\";\n}\n\nmjx-c.mjx-c34::before {\n  padding: 0.677em 0.5em 0 0;\n  content: \"4\";\n}\n\nmjx-c.mjx-c1D44E.TEX-I::before {\n  padding: 0.441em 0.529em 0.01em 0;\n  content: \"a\";\n}\n\nmjx-c.mjx-c37::before {\n  padding: 0.676em 0.5em 0.022em 0;\n  content: \"7\";\n}\n\nmjx-c.mjx-c35::before {\n  padding: 0.666em 0.5em 0.022em 0;\n  content: \"5\";\n}\n\nmjx-c.mjx-c3A3::before {\n  padding: 0.683em 0.722em 0 0;\n  content: \"\\3A3\";\n}\n\nmjx-c.mjx-c1D443.TEX-I::before {\n  padding: 0.683em 0.751em 0 0;\n  content: \"P\";\n}\n\nmjx-c.mjx-c1D5AD.TEX-SS::before {\n  padding: 0.694em 0.708em 0 0;\n  content: \"N\";\n}\n\nmjx-c.mjx-c1D5AF.TEX-SS::before {\n  padding: 0.694em 0.639em 0 0;\n  content: \"P\";\n}\n\nmjx-c.mjx-c1D5B2.TEX-SS::before {\n  padding: 0.716em 0.556em 0.022em 0;\n  content: \"S\";\n}\n\nmjx-c.mjx-c1D5A0.TEX-SS::before {\n  padding: 0.694em 0.667em 0 0;\n  content: \"A\";\n}\n\nmjx-c.mjx-c1D5A2.TEX-SS::before {\n  padding: 0.705em 0.639em 0.011em 0;\n  content: \"C\";\n}\n\nmjx-c.mjx-c1D5A4.TEX-SS::before {\n  padding: 0.691em 0.597em 0 0;\n  content: \"E\";\n}\n\nmjx-c.mjx-cAC::before {\n  padding: 0.356em 0.667em 0 0;\n  content: \"\\AC\";\n}\n\nmjx-c.mjx-c1D463.TEX-I::before {\n  padding: 0.443em 0.485em 0.011em 0;\n  content: \"v\";\n}\n\nmjx-c.mjx-c2228::before {\n  padding: 0.598em 0.667em 0.022em 0;\n  content: \"\\2228\";\n}\n\nmjx-c.mjx-c1D431.TEX-B::before {\n  padding: 0.444em 0.607em 0 0;\n  content: \"x\";\n}\n\nmjx-c.mjx-c1D41B.TEX-B::before {\n  padding: 0.694em 0.639em 0.006em 0;\n  content: \"b\";\n}\n\nmjx-c.mjx-c2026::before {\n  padding: 0.12em 1.172em 0 0;\n  content: \"\\2026\";\n}\n\nmjx-c.mjx-c1D45B.TEX-I::before {\n  padding: 0.442em 0.6em 0.011em 0;\n  content: \"n\";\n}\n\nmjx-c.mjx-c22EF::before {\n  padding: 0.31em 1.172em 0 0;\n  content: \"\\22EF\";\n}\n\nmjx-c.mjx-c1D446.TEX-I::before {\n  padding: 0.705em 0.645em 0.022em 0;\n  content: \"S\";\n}\n\nmjx-c.mjx-c7B::before {\n  padding: 0.75em 0.5em 0.25em 0;\n  content: \"{\";\n}\n\nmjx-c.mjx-cA0::before {\n  padding: 0 0.25em 0 0;\n  content: \"\\A0\";\n}\n\nmjx-c.mjx-c7C::before {\n  padding: 0.75em 0.278em 0.249em 0;\n  content: \"|\";\n}\n\nmjx-c.mjx-c2208::before {\n  padding: 0.54em 0.667em 0.04em 0;\n  content: \"\\2208\";\n}\n\nmjx-c.mjx-c2124.TEX-A::before {\n  padding: 0.683em 0.667em 0 0;\n  content: \"Z\";\n}\n\nmjx-c.mjx-c1D464.TEX-I::before {\n  padding: 0.443em 0.716em 0.011em 0;\n  content: \"w\";\n}\n\nmjx-c.mjx-c7D::before {\n  padding: 0.75em 0.5em 0.25em 0;\n  content: \"}\";\n}\n\nmjx-c.mjx-c2113::before {\n  padding: 0.705em 0.417em 0.02em 0;\n  content: \"\\2113\";\n}\n\nmjx-c.mjx-c1D42F.TEX-B::before {\n  padding: 0.444em 0.607em 0 0;\n  content: \"v\";\n}\n\nmjx-c.mjx-c2211.TEX-S1::before {\n  padding: 0.75em 1.056em 0.25em 0;\n  content: \"\\2211\";\n}\n\nmjx-c.mjx-c1D456.TEX-I::before {\n  padding: 0.661em 0.345em 0.011em 0;\n  content: \"i\";\n}\n\nmjx-c.mjx-c2016::before {\n  padding: 0.75em 0.5em 0.25em 0;\n  content: \"\\2225\";\n}\n\nmjx-c.mjx-c211D.TEX-A::before {\n  padding: 0.683em 0.722em 0 0;\n  content: \"R\";\n}\n\nmjx-c.mjx-c1D452.TEX-I::before {\n  padding: 0.442em 0.466em 0.011em 0;\n  content: \"e\";\n}\n\nmjx-c.mjx-c2261::before {\n  padding: 0.464em 0.778em 0 0;\n  content: \"\\2261\";\n}\n\nmjx-c.mjx-c1D467.TEX-I::before {\n  padding: 0.442em 0.465em 0.011em 0;\n  content: \"z\";\n}\n"}},"__N_SSG":true}