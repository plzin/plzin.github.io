{"pageProps":{"postData":{"title":"Mixed boolean-arithmetic (Part 1): Introduction","date":"2022-06-07","id":"mba","contentHtml":"<p>What does the following function do?</p>\n<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">int</span> <span class=\"token function\">hmm</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> y<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">^</span> y<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">&#x26;</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>Maybe, if you computed some examples, you could figure it out, because what the function computes is fairly simple.\nYou could also try to decipher what happens on the bit level without computing any examples, although it probably isn't that easy.\nWhat the function uses is called <strong>Mixed boolean-arithmetic</strong> (MBA): It combines arithmetic operations (+, -, *, /) with boolean operations (&#x26;, |, ^, ~).</p>\n<p>I will tell you what that function does though.\nThe function adds <code>x</code> and <code>y</code>.\nYou can see this by considering what the two terms (<code>x ^ y</code> and <code>x &#x26; y</code>) represent:</p>\n<p><code>x ^ y</code> is the sum of <code>x</code> and <code>y</code> without carries.\nE.g. <code>11 ^ 01 = 10</code>, because we add the 1's in the least significant bit which gives us 0 and a carry of 1 but we just ignore the carry\nand continue with the next bit.</p>\n<p><code>x &#x26; y</code> has bits set to 1 in positions where a carry is 'generated', i.e. when the two bits are 1.\nMultiplying that by 2 shifts those bits to the left by one.\n(Remember multiplication by <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container> is just a shift by <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container>).\nThese bits are now in the correct position to be added to the result of the carry-less addition.\n(When a carry happens you add the carry to the result of the next digit/bit.)</p>\n<p>That's pretty cool! Can we automate it, i.e. automatically generate MBA expressions?\nYes we can, look at the following function:</p>\n<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">int</span> <span class=\"token function\">what</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> y<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> z<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> d <span class=\"token operator\">=</span> <span class=\"token number\">3114439982</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">&#x26;</span> y<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1557219991</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">^</span> y<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">2147483648</span> <span class=\"token operator\">*</span> <span class=\"token operator\">~</span><span class=\"token punctuation\">(</span>y <span class=\"token operator\">^</span> y <span class=\"token operator\">^</span> z<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">302211727</span> <span class=\"token operator\">*</span> <span class=\"token operator\">~</span>y\n        <span class=\"token operator\">+</span> <span class=\"token number\">582187895</span> <span class=\"token operator\">*</span> <span class=\"token operator\">~</span>y <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">3122515744</span> <span class=\"token operator\">*</span> y <span class=\"token operator\">+</span> <span class=\"token number\">3410567674</span> <span class=\"token operator\">*</span> z\n        <span class=\"token operator\">+</span> <span class=\"token number\">3031883270</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">&#x26;</span> z<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">3402491911</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">|</span> z<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">+</span> <span class=\"token number\">3402491911</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>y <span class=\"token operator\">&#x26;</span> z<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1263084026</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">|</span> <span class=\"token operator\">~</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">int</span> c <span class=\"token operator\">=</span> <span class=\"token number\">968665204</span> <span class=\"token operator\">+</span> d <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1490187595</span> <span class=\"token operator\">+</span> d <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2190486832</span> <span class=\"token operator\">+</span> d <span class=\"token operator\">*</span> <span class=\"token number\">1984426948</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">int</span> b <span class=\"token operator\">=</span> <span class=\"token number\">1638991652</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3509105699</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2567890784</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">218661116</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3837987200</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3840643600</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">4291667968</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">123786496</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">4294891520</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">27030784</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">4291321856</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">11271168</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">4293525504</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">114688</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">4293918720</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">1441792</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token operator\">+</span> c <span class=\"token operator\">*</span> <span class=\"token number\">65536</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">int</span> a <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">916623562</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">&#x26;</span> b<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">3679537253</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">^</span> b<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">+</span> <span class=\"token number\">3221225472</span> <span class=\"token operator\">*</span> <span class=\"token operator\">~</span><span class=\"token punctuation\">(</span>x <span class=\"token operator\">^</span> b <span class=\"token operator\">^</span> z<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">3983377</span> <span class=\"token operator\">*</span> <span class=\"token operator\">~</span>x\n        <span class=\"token operator\">+</span> <span class=\"token number\">2410021085</span> <span class=\"token operator\">*</span> <span class=\"token operator\">~</span>b <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">3574118078</span> <span class=\"token operator\">*</span> b <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">258554060</span> <span class=\"token operator\">*</span> z\n        <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">815187764</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>b <span class=\"token operator\">&#x26;</span> z<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">2601812053</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">|</span> z<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">+</span> <span class=\"token number\">3840638891</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>x <span class=\"token operator\">&#x26;</span> z<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">2962671412</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>b <span class=\"token operator\">|</span> <span class=\"token operator\">~</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1253380852</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">&#x26;</span> b<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">1700432250</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">^</span> b<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">3221225472</span> <span class=\"token operator\">*</span> <span class=\"token operator\">~</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">^</span> b <span class=\"token operator\">^</span> z<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1975477278</span> <span class=\"token operator\">*</span> <span class=\"token operator\">~</span>a\n        <span class=\"token operator\">+</span> <span class=\"token number\">1536970157</span> <span class=\"token operator\">*</span> <span class=\"token operator\">~</span>b <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">4278790360</span> <span class=\"token operator\">*</span> b <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">1364963787</span> <span class=\"token operator\">*</span> z\n        <span class=\"token operator\">+</span> <span class=\"token number\">2438705611</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>b <span class=\"token operator\">&#x26;</span> z<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">454684057</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">|</span> z<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">+</span> <span class=\"token number\">1692799591</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>a <span class=\"token operator\">&#x26;</span> z<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">4003745333</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>b <span class=\"token operator\">|</span> <span class=\"token operator\">~</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>It again computer <code>x + y</code>. The value of <code>z</code> does not matter.\nIn this series of posts I will explain how you can do that (obfuscation) and possibly also how you can go undo (deobfuscate) them.\nThis post will go over the basics and explain how these expressions are generated.\nThere will be two problems whose solution will be presented in the following two blog posts and they will use some algebra (<a href=\"https://en.wikipedia.org/wiki/Ring_(mathematics)\">rings</a>, <a href=\"https://en.wikipedia.org/wiki/Ideal_(ring_theory)\">ideals</a>).</p>\n<h1>Basics</h1>\n<p>There are two primitives used by used in MBA expressions, which were presented in the <a href=\"https://link.springer.com/chapter/10.1007/978-3-540-77535-5_5\">original paper</a>:</p>\n<ul>\n<li>(Linear) MBA identities</li>\n<li>Permutation polynomials</li>\n</ul>\n<!-- Split multiplications into shift and add -->\n<!-- Implement division by constant as multiplication of the inverse -->\n<p>(Linear) MBA identities are things like <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2295\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c22C5\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2227\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo></mjx-math></mjx-container>.\nThis particular one works for numbers of any size (number of bits), but in general they can be specific to a certain bitness.\nLinear means that the expression is a linear combination of boolean expressions.</p>\n<p>Permutation polynomials permute the <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container>-bit numbers.\nAnd the inverse function is also a (permutation) polynomial.\nAn example for 8 bits looks like this:\n<mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\" display=\"true\"><mjx-math display=\"true\" style=\"margin-left: 0; margin-right: 0;\" class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45D TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c39\"></mjx-c><mjx-c class=\"mjx-c36\"></mjx-c></mjx-mn><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.413em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c33\"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c34\"></mjx-c><mjx-c class=\"mjx-c38\"></mjx-c></mjx-mn><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.413em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c37\"></mjx-c><mjx-c class=\"mjx-c35\"></mjx-c></mjx-mn><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c36\"></mjx-c></mjx-mn></mjx-math></mjx-container>\n<mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\" display=\"true\"><mjx-math display=\"true\" style=\"margin-left: 0; margin-right: 0;\" class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45E TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c36\"></mjx-c></mjx-mn><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.413em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c35\"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c32\"></mjx-c><mjx-c class=\"mjx-c34\"></mjx-c></mjx-mn><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.413em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c33\"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c39\"></mjx-c><mjx-c class=\"mjx-c36\"></mjx-c></mjx-mn><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.413em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c33\"></mjx-c><mjx-c class=\"mjx-c35\"></mjx-c></mjx-mn><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c33\"></mjx-c><mjx-c class=\"mjx-c36\"></mjx-c></mjx-mn></mjx-math></mjx-container></p>\n<p><mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45E TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container> and <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45D TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container> are inverses of each other (<mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45D TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45E TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"4\"><mjx-c class=\"mjx-c1D45E TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45D TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"4\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container>).</p>\n<p>The problem in both cases is how to automatically generate these.</p>\n<h3>Small history of MBA</h3>\n<p>The <a href=\"https://link.springer.com/chapter/10.1007/978-3-540-77535-5_5\">original paper</a> on mixed boolean arithmetic, which – as far as I know – also introduced the term, was published in 2007.\nBut even before that in 2001 Rivest (of <strong>R</strong>SA fame) published a <a href=\"https://www.sciencedirect.com/science/article/pii/S107157970090282X?via%3Dihub\">characterization of permutation polynomials</a>, but without a way to find their inverses.\nThe 2007 paper included a subset of permutation polynomials and a formula for their inverses.\nA way to <a href=\"https://dl.acm.org/doi/10.1145/2995306.2995310\">compute the inverse of a general permutation polynomials</a> was only published in 2016.</p>\n<h1>MBA Identities</h1>\n<p>To me personally, this seems like it should be the harder of the two problems.\nIt seems like there should just be some neat formula to find the inverse of a permutation polynomial,\nbut historically this problem was solved first.</p>\n<p>How would you go about automatically creating (linear) MBA identities?\nIn the first code example there was this neat explanation that <code>x &#x26; y</code> are the carry bits which are shifted by multiplying it by 2 and <code>x ^ y</code> is addition without carry.\nObviously such nice explanations won't always exist or be automatically derivable.</p>\n<p>Let's still use that as an example:\nWe want to rewrite <code>x + y</code> using <code>x ^ y</code> and <code>x &#x26; y</code>.\nWhat you can do is make a table of all possible input combinations and the value of the boolean expressions (<code>x &#x26; y</code>, <code>x ^ y</code>) and expression you want to rewrite (<code>x + y</code>).\nWe will assume <code>x</code> and <code>y</code> are 2-bit numbers.</p>\n<code>\n<table style=\"width: 50%\">\n  <colgroup>\n    <col style=\"width: 3em\">\n    <col style=\"border-right: 2px solid var(--border-2); width: 3em\">\n  </colgroup>\n  <thead style=\"\">\n    <tr>\n      <th>x</th>\n      <th>y</th>\n      <th>x ^ y</th>\n      <th>x &#x26; y</th>\n      <th>x + y</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <td>0</td>\n      <td>2</td>\n      <td>2</td>\n      <td>0</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <td>0</td>\n      <td>3</td>\n      <td>3</td>\n      <td>0</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <td>..</td>\n      <td>..</td>\n      <td>..</td>\n      <td>..</td>\n      <td>..</td>\n    </tr>\n    <tr>\n      <td>3</td>\n      <td>3</td>\n      <td>0</td>\n      <td>3</td>\n      <td>6</td>\n    </tr>\n  </tbody>\n</table>\n</code>\n<p>You can verify that indeed <code>(x ^ y) + 2 * (x &#x26; y)</code> equals <code>x + y</code>.</p>\n<p>We can write this in matrix form as:</p>\n<p><mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\" display=\"true\"><mjx-math display=\"true\" style=\"margin-left: 0; margin-right: 0;\" class=\"MJX-TEX\"><mjx-mrow><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 10.8em; vertical-align: -5.15em;\" class=\"mjx-c5B\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=\"min-width: 2.445em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-right: 0.5em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c33\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-right: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2E\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c2E\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em; padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2E\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c2E\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-right: 0.5em; padding-top: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em; padding-top: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c33\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 10.8em; vertical-align: -5.15em;\" class=\"mjx-c5D\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mrow space=\"2\"><mjx-mo class=\"mjx-s3\"><mjx-c class=\"mjx-c5B TEX-S3\"></mjx-c></mjx-mo><mjx-mtable style=\"min-width: 0.5em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-s3\"><mjx-c class=\"mjx-c5D TEX-S3\"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mrow space=\"4\"><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 10.8em; vertical-align: -5.15em;\" class=\"mjx-c5B\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=\"min-width: 0.723em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c33\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2E\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c2E\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c36\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 10.8em; vertical-align: -5.15em;\" class=\"mjx-c5D\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow></mjx-math></mjx-container></p>\n<p>The first matrix contains the <code>x ^ y</code> and <code>x &#x26; y</code> columns from the table.\nThe vector contains the coefficients of the linear combination.\nThe last vector contains the <code>x + y</code> row from the table.\nMaybe you can see where this is going.\nWe construct the matrix and the last vector and solve the linear system of equations.</p>\n<p>There are just two problems with this:</p>\n<ol>\n<li>The full table would be 16 rows, or <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-texatom size=\"s\" texclass=\"ORD\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45A TEX-I\"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup></mjx-math></mjx-container> where <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container> is the bitness and <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45A TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container> the number of variables. This will be way too big for realistic <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container>.</li>\n<li>We are looking for integer solutions and the equations are modulo <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container>. You could say we are solving the system over <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c2124 TEX-A\"></mjx-c></mjx-mi></mjx-texatom><mjx-texatom texclass=\"ORD\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2F\"></mjx-c></mjx-mo></mjx-texatom><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c2124 TEX-A\"></mjx-c></mjx-mi></mjx-texatom></mjx-math></mjx-container> which are the integers mod <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container>. Unfortunately this is not a <a href=\"https://en.wikipedia.org/wiki/Field_(mathematics)\">field</a>, meaning usual linear algebra won't work, i.e. standard gaussian elimination can't solve this.</li>\n</ol>\n<p>The second problem will be the topic of the second post in this series.\nThe first one we can address right here.\nThere is one crucial property we haven't used yet.\nIn the above construction we can use any function for rewriting, it doesn't have to be a boolean operation, which is nice, but only in restricting the class of functions does this actually become practical.\nBecause unlike general functions, boolean operations are just applied bitwise, meaning the value of bit i of the output only depends on bits i of the inputs.\nI will refer to functions with this property as bitwise functions.\nBasically any function <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D453 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3A\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c7B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-msup><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c7D\"></mjx-c></mjx-mo><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45A TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c2192\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c7B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c7D\"></mjx-c></mjx-mo></mjx-math></mjx-container> that is applied to each bit separately is a bitwise function. (There are only 16 such functions).\nFor example bit i of <code>x * y</code> depends on a lot of bits and not just bit i of <code>x</code> and bit i of <code>y</code>, so <code>*</code> is not a bitwise function whereas <code>&#x26;</code> is.</p>\n<p>This property of boolean operations makes it possible to restrict the inputs we have to consider to just 0 and 1 for each input (I won't prove this here).\nIn the example above, we would only have the following table with 4 rows instead of 16 or in general <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45A TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container> instead of <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-texatom size=\"s\" texclass=\"ORD\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45A TEX-I\"></mjx-c></mjx-mi><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup></mjx-math></mjx-container>.</p>\n<code>\n<table style=\"width: 50%\">\n  <colgroup>\n    <col style=\"width: 3em\">\n    <col style=\"border-right: 2px solid var(--border-2); width: 3em\">\n  </colgroup>\n  <thead>\n    <tr>\n      <th>x</th>\n      <th>y</th>\n      <th>x ^ y</th>\n      <th>x &#x26; y</th>\n      <th>x + y</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n  </tbody>\n</table>\n</code>\n<p><code>x + y</code> is not bitwise, why is it still allowed?\nThat's because the set of functions allowed is actually slightly bigger.\nLinear combinations of bitwise functions are also allowed.\n(Supplying a linear combination of bitwise function instead of supplying the bitwise functions separately amounts to limiting the coefficients that are allowed in the linear combination.)\n<code>x + y</code> is just a linear combination with coefficients 1 of the identity function on <code>x</code> and <code>y</code>.</p>\n<p>Solving these linear systems will be the subject of the second post.</p>\n<h1>Permutation polynomials</h1>\n<p>There is a simple characterization of permutation polynomials which allows us to generate them very easily.\nThis characterization is due to <a href=\"https://www.sciencedirect.com/science/article/pii/S107157970090282X?via%3Dihub\">Rivest</a>:</p>\n<p>A polynomial <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45D TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-msub space=\"4\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c22EF\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D451 TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D451 TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container> over <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c2124 TEX-A\"></mjx-c></mjx-mi></mjx-texatom><mjx-texatom texclass=\"ORD\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2F\"></mjx-c></mjx-mo></mjx-texatom><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c2124 TEX-A\"></mjx-c></mjx-mi></mjx-texatom></mjx-math></mjx-container> is a permutation polynomial if and only if</p>\n<ul>\n<li><mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math></mjx-container> is odd</li>\n<li><mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c34\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c36\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2026\"></mjx-c></mjx-mo></mjx-math></mjx-container> is even</li>\n<li><mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c33\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c35\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c37\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2026\"></mjx-c></mjx-mo></mjx-math></mjx-container> is even</li>\n</ul>\n<p>The problem then, is finding the inverse to such a polynomial.\nAs mentioned, this is not trivial in general, but we can quickly take a look at a simple example where <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D451 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c64\"></mjx-c><mjx-c class=\"mjx-c65\"></mjx-c><mjx-c class=\"mjx-c67\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2061\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"2\"><mjx-c class=\"mjx-c1D45D TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-math></mjx-container>: <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45D TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-msub space=\"4\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math></mjx-container>.\nThese are used as <a href=\"https://en.wikipedia.org/wiki/Linear_congruential_generator\">Linear Congruential Generators</a> (although the modulus need not be a power of two) that are used as very simple (and definitely not cryptographically secure) random number generators.</p>\n<p>The following discussion is not strictly necessary to understand the rest of this post. It is more for the fun of it.</p>\n<p>It is fairly easy to see that the value of <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math></mjx-container> neither makes nor breaks a permutation polynomial and can be chosen freely.\nLet's set <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-math></mjx-container>.\nWhat values can <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math></mjx-container> take?\nIt is pretty clear that <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math></mjx-container> can't be even, otherwise <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container> can only be equal to an even number mod <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container>.\nBut it can actually equal any odd number.\nThe reason is that any odd number has a multiplicative inverse in <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c2124 TEX-A\"></mjx-c></mjx-mi></mjx-texatom><mjx-texatom texclass=\"ORD\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2F\"></mjx-c></mjx-mo></mjx-texatom><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c2124 TEX-A\"></mjx-c></mjx-mi></mjx-texatom></mjx-math></mjx-container>, since <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container> has only the prime factor 2 and thus the greatest common divisor of an odd number and <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msup><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mi class=\"mjx-i\" size=\"s\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math></mjx-container> is 1.\nThe inverse <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msubsup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.297em; margin-left: 0;\"><mjx-texatom size=\"s\" texclass=\"ORD\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-texatom><mjx-spacer style=\"margin-top: 0.18em;\"></mjx-spacer><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msubsup></mjx-math></mjx-container> can be computed with the <a href=\"https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm#Modular_integers\">extended euclidean algorithm</a>.\n<mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container> maps to <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container> for <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-msubsup space=\"4\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.297em; margin-left: 0;\"><mjx-texatom size=\"s\" texclass=\"ORD\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-texatom><mjx-spacer style=\"margin-top: 0.18em;\"></mjx-spacer><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container>.</p>\n<p>We can also easily compute the inverse <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45E TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-msub space=\"4\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44F TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44F TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math></mjx-container>.\n<mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\" display=\"true\"><mjx-math display=\"true\" style=\"margin-left: 0; margin-right: 0;\" class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45E TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45D TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-msub space=\"4\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44F TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44F TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-msub space=\"4\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44F TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44F TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44F TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-texatom space=\"4\" texclass=\"REL\"><mjx-mover><mjx-over style=\"padding-bottom: 0.2em; padding-left: 0.291em;\"><mjx-texatom size=\"s\" texclass=\"ORD\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c21\"></mjx-c></mjx-mo></mjx-texatom></mjx-over><mjx-base><mjx-texatom texclass=\"OP\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo></mjx-texatom></mjx-base></mjx-mover></mjx-texatom><mjx-mi class=\"mjx-i\" space=\"4\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container>\nBy equating coefficients, we get:\n<mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\" display=\"true\"><mjx-math display=\"true\" style=\"margin-left: 0; margin-right: 0;\" class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44F TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-mstyle><mjx-mspace style=\"width: 0.278em;\"></mjx-mspace></mjx-mstyle><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c27F9\"></mjx-c></mjx-mo><mjx-mstyle><mjx-mspace style=\"width: 0.278em;\"></mjx-mspace></mjx-mstyle><mjx-msub space=\"4\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44F TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-msubsup space=\"4\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.296em; margin-left: 0;\"><mjx-texatom size=\"s\" texclass=\"ORD\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-texatom><mjx-spacer style=\"margin-top: 0.18em;\"></mjx-spacer><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msubsup></mjx-math></mjx-container>\n<mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\" display=\"true\"><mjx-math display=\"true\" style=\"margin-left: 0; margin-right: 0;\" class=\"MJX-TEX\"><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44F TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44F TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-msubsup space=\"4\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.296em; margin-left: 0;\"><mjx-texatom size=\"s\" texclass=\"ORD\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-texatom><mjx-spacer style=\"margin-top: 0.18em;\"></mjx-spacer><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-msub space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44F TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-mstyle><mjx-mspace style=\"width: 0.278em;\"></mjx-mspace></mjx-mstyle><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c27F9\"></mjx-c></mjx-mo><mjx-mstyle><mjx-mspace style=\"width: 0.278em;\"></mjx-mspace></mjx-mstyle><mjx-msub space=\"4\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44F TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.296em; margin-left: 0;\"><mjx-texatom size=\"s\" texclass=\"ORD\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-texatom><mjx-spacer style=\"margin-top: 0.18em;\"></mjx-spacer><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math></mjx-container>\nSo in general the inverse is given by\n<mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\" display=\"true\"><mjx-math display=\"true\" style=\"margin-left: 0; margin-right: 0;\" class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45E TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-msubsup space=\"4\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.296em; margin-left: 0;\"><mjx-texatom size=\"s\" texclass=\"ORD\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-texatom><mjx-spacer style=\"margin-top: 0.18em;\"></mjx-spacer><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-msubsup space=\"3\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.296em; margin-left: 0;\"><mjx-texatom size=\"s\" texclass=\"ORD\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-texatom><mjx-spacer style=\"margin-top: 0.18em;\"></mjx-spacer><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-msub><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D44E TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: -0.15em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math></mjx-container></p>\n<p>For higher degree polynomials this becomes much more difficult and, as far as I know, no general formula for the inverse of a permutation polynomial exists.\nThough there is an algorithm that seems to work, but there isn't really a proof of correctness.</p>\n<!--<mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\" MJX-TEX\"><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.363em;\"><mjx-TeXAtom size=\"s\" texclass=\"ORD\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c32\"></mjx-c><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c39\"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c30\"></mjx-c><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c38\"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c32\"></mjx-c><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c37\"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c34\"></mjx-c><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c36\"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c32\"></mjx-c><mjx-c class=\"mjx-c34\"></mjx-c><mjx-c class=\"mjx-c33\"></mjx-c></mjx-mn><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c35\"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c32\"></mjx-c><mjx-c class=\"mjx-c32\"></mjx-c><mjx-c class=\"mjx-c34\"></mjx-c></mjx-mn><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c34\"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c33\"></mjx-c><mjx-c class=\"mjx-c36\"></mjx-c></mjx-mn><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c33\"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c36\"></mjx-c></mjx-mn><mjx-msup><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-script style=\"vertical-align: 0.363em;\"><mjx-mn class=\"mjx-n\" size=\"s\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2B\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c32\"></mjx-c><mjx-c class=\"mjx-c38\"></mjx-c></mjx-mn><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container>-->\n<h1>Obfuscating integers</h1>\n<p>Of course, there are many ways to combine these primitives.\nThe example at the beginning was just some combination of the two.\nOne application I particularly like is obfuscating integers.</p>\n<p>Let us fix the number of variables <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45A TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-math></mjx-container> for simplicity.\nI will be using the shorthand\n<mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\" display=\"true\"><mjx-math display=\"true\" style=\"margin-left: 0; margin-right: 0;\" class=\"MJX-TEX\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D453 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mrow space=\"4\"><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 5.2em; vertical-align: -2.35em;\" class=\"mjx-c5B\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=\"min-width: 2.773em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-bottom: 0.2em;\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D453 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D453 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D453 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em;\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D453 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 5.2em; vertical-align: -2.35em;\" class=\"mjx-c5D\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2C\"></mjx-c></mjx-mo><mjx-mspace style=\"width: 2.088em;\"></mjx-mspace><mjx-mtext class=\"mjx-n\" space=\"2\"><mjx-c class=\"mjx-c65\"></mjx-c><mjx-c class=\"mjx-c2E\"></mjx-c><mjx-c class=\"mjx-c67\"></mjx-c><mjx-c class=\"mjx-c2E\"></mjx-c><mjx-c class=\"mjx-cA0\"></mjx-c></mjx-mtext><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2295\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mrow space=\"4\"><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 5.2em; vertical-align: -2.35em;\" class=\"mjx-c5B\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style=\"min-width: 0.5em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em; padding-bottom: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style=\"padding-top: 0.2em;\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c30\"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-stretchy-v style=\"height: 5.2em; vertical-align: -2.35em;\" class=\"mjx-c5D\"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo></mjx-mrow></mjx-math></mjx-container></p>\n<p>Let's fix the operations used for rewriting as <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2295\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container>, <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2227\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi></mjx-math></mjx-container> and <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mi class=\"mjx-n\"><mjx-c class=\"mjx-cAC\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2228\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo></mjx-math></mjx-container> and the constant to obfuscate as <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c33\"></mjx-c><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-math></mjx-container>.\nThese are sufficient to obfuscate any constant (but they will always result in the same linear combination, so you should provide more if possible).</p>\n<p>You might just try to do this:\n<mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\" display=\"true\"><mjx-math display=\"true\" style=\"margin-left: 0; margin-right: 0;\" class=\"MJX-TEX\"><mjx-mrow><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c5B\"></mjx-c></mjx-mo><mjx-mtable style=\"min-width: 12.41em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-right: 0.5em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2295\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em; padding-right: 0.5em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2227\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-n\"><mjx-c class=\"mjx-cAC\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2228\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c5D\"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c22C5\"></mjx-c></mjx-mo><mjx-mtext class=\"mjx-b\" space=\"3\"><mjx-c class=\"mjx-c1D41A TEX-B\"></mjx-c></mjx-mtext><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c33\"></mjx-c><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo></mjx-math></mjx-container></p>\n<p>If you tried this, you would find that the expression would evaluate to the constant -1312.\nThis is very close to the real solution, but there are some misconceptions at play here.\nThe constant <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c33\"></mjx-c><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn></mjx-math></mjx-container> is not a bitwise function, because there is a different function for bits in different positions.\nFor some bits it is the constant 0 function and for the others the constant 1.\nWe know though, that these functions are allowed to be linear combinations of bitwise functions, so maybe this would work:</p>\n<p><mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\" display=\"true\"><mjx-math display=\"true\" style=\"margin-left: 0; margin-right: 0;\" class=\"MJX-TEX\"><mjx-mrow><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c5B\"></mjx-c></mjx-mo><mjx-mtable style=\"min-width: 12.41em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-right: 0.5em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2295\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em; padding-right: 0.5em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2227\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-n\"><mjx-c class=\"mjx-cAC\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2228\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c5D\"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c22C5\"></mjx-c></mjx-mo><mjx-mtext class=\"mjx-b\" space=\"3\"><mjx-c class=\"mjx-c1D41A TEX-B\"></mjx-c></mjx-mtext><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c33\"></mjx-c><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c22C5\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo></mjx-math></mjx-container></p>\n<p>This is still exactly the same system of equations as above. So while it is conceptually clearer, it is still incorrect.\nSuppose we initialize an 8-bit number with the constant <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn></mjx-math></mjx-container> function.\nWhat value would be stored in that number?\nWould the number represent the value 1?\nWhat would its bits look like?\nEvery bit would be a one, so the number would be <code>0xff = 255</code> or <code>-1</code> if the number was signed (interpreted in <a href=\"https://en.wikipedia.org/wiki/Two%27s_complement\">two's complement</a>).\nAnd this will be the clue to getting it right.\nI won't prove this here, but we can just interpret the number in two's complement, so the constant one function represents the number -1 and the coefficient we want is then -1312.\nThe correct equation is</p>\n<p><mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\" display=\"true\"><mjx-math display=\"true\" style=\"margin-left: 0; margin-right: 0;\" class=\"MJX-TEX\"><mjx-mrow><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c5B\"></mjx-c></mjx-mo><mjx-mtable style=\"min-width: 12.41em;\"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style=\"padding-right: 0.5em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2295\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em; padding-right: 0.5em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2227\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd><mjx-mtd style=\"padding-left: 0.5em;\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-n\"><mjx-c class=\"mjx-cAC\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c28\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D465 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c2228\"></mjx-c></mjx-mo><mjx-mi class=\"mjx-i\" space=\"3\"><mjx-c class=\"mjx-c1D466 TEX-I\"></mjx-c></mjx-mi><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c29\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c5D\"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c22C5\"></mjx-c></mjx-mo><mjx-mtext class=\"mjx-b\" space=\"3\"><mjx-c class=\"mjx-c1D41A TEX-B\"></mjx-c></mjx-mtext><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c3D\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"4\"><mjx-c class=\"mjx-c2212\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c33\"></mjx-c><mjx-c class=\"mjx-c31\"></mjx-c><mjx-c class=\"mjx-c32\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c22C5\"></mjx-c></mjx-mo><mjx-mo class=\"mjx-n\" space=\"3\"><mjx-c class=\"mjx-c27E8\"></mjx-c></mjx-mo><mjx-mn class=\"mjx-n\"><mjx-c class=\"mjx-c31\"></mjx-c></mjx-mn><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c27E9\"></mjx-c></mjx-mo></mjx-math></mjx-container></p>\n<p>Here is an example with a few more input operations.</p>\n<pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">int</span> <span class=\"token function\">c</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> y<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Rewrite `x &#x26; y` using a permutation polynomial.</span>\n    <span class=\"token keyword\">int</span> a <span class=\"token operator\">=</span> x <span class=\"token operator\">&#x26;</span> y<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Use Horner's method to evaluate the degree 8 polynomial.</span>\n    <span class=\"token keyword\">int</span> b <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">18874368</span><span class=\"token operator\">*</span>a <span class=\"token operator\">+</span> <span class=\"token number\">263192576</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>a <span class=\"token operator\">+</span> <span class=\"token number\">127991808</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>a\n        <span class=\"token operator\">+</span> <span class=\"token number\">3775242240</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>a <span class=\"token operator\">+</span> <span class=\"token number\">3978920448</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>a <span class=\"token operator\">+</span> <span class=\"token number\">3595255168</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>a\n        <span class=\"token operator\">+</span> <span class=\"token number\">826953192</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>a <span class=\"token operator\">+</span> <span class=\"token number\">2187683531</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>a <span class=\"token operator\">+</span> <span class=\"token number\">3537295417</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Use an MBA identity that evaluates to b.</span>\n    <span class=\"token keyword\">int</span> c <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">2939841818</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>b <span class=\"token operator\">&#x26;</span> y<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">396179085</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>b <span class=\"token operator\">^</span> y<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">+</span> <span class=\"token number\">1073741824</span> <span class=\"token operator\">*</span> <span class=\"token operator\">~</span><span class=\"token punctuation\">(</span>b <span class=\"token operator\">^</span> y <span class=\"token operator\">^</span> a<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">2650142651</span> <span class=\"token operator\">*</span> <span class=\"token operator\">~</span>b\n        <span class=\"token operator\">+</span> <span class=\"token number\">2049622064</span> <span class=\"token operator\">*</span> <span class=\"token operator\">~</span>y <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">775424323</span> <span class=\"token operator\">*</span> y <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">1546963061</span> <span class=\"token operator\">*</span> a\n        <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">1674262411</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">&#x26;</span> a<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">3114745555</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>b <span class=\"token operator\">|</span> a<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">+</span> <span class=\"token number\">3327705389</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>b <span class=\"token operator\">&#x26;</span> a<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">3821746059</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">|</span> <span class=\"token operator\">~</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Evaluate the inverse.</span>\n    <span class=\"token keyword\">int</span> d <span class=\"token operator\">=</span> <span class=\"token number\">2025852808</span><span class=\"token operator\">*</span>c<span class=\"token operator\">*</span>c <span class=\"token operator\">+</span> <span class=\"token number\">2628772947</span><span class=\"token operator\">*</span>c <span class=\"token operator\">+</span> <span class=\"token number\">2801763453</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Use the MBA identity that evaluates to 1312.</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">3051142224</span> <span class=\"token operator\">*</span> d <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">2599312936</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">^</span> y<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">+</span> <span class=\"token number\">3221225472</span> <span class=\"token operator\">*</span> <span class=\"token operator\">~</span><span class=\"token punctuation\">(</span>x <span class=\"token operator\">^</span> y <span class=\"token operator\">^</span> b<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">1555555228</span> <span class=\"token operator\">*</span> <span class=\"token operator\">~</span>x\n        <span class=\"token operator\">+</span> <span class=\"token number\">2395047580</span> <span class=\"token operator\">*</span> <span class=\"token operator\">~</span>y <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">374348604</span> <span class=\"token operator\">*</span> y <span class=\"token operator\">+</span> <span class=\"token number\">1307989984</span> <span class=\"token operator\">*</span> b\n        <span class=\"token operator\">+</span> <span class=\"token number\">1913235488</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">&#x26;</span> b<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">4264983180</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">|</span> b<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">+</span> <span class=\"token number\">2177467764</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>x <span class=\"token operator\">&#x26;</span> b<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">234248160</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">|</span> <span class=\"token operator\">~</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h1>What's next?</h1>\n<p>If you want to try this for yourself, check out my web interface <a href=\"https://plzin.github.io/mba-wasm/\">here</a>.\nMy initial implementation using arbitrary precision integers can be found <a href=\"https://github.com/plzin/mba\">here</a>.\nThe <a href=\"/posts/linear-systems-mod-n\">next post</a> is about solving linear systems over <mjx-container class=\"MathJax\" jax=\"CHTML\" style=\"font-size: 110%;\"><mjx-math class=\"MJX-TEX\"><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c2124 TEX-A\"></mjx-c></mjx-mi></mjx-texatom><mjx-texatom texclass=\"ORD\"><mjx-mo class=\"mjx-n\"><mjx-c class=\"mjx-c2F\"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class=\"mjx-i\"><mjx-c class=\"mjx-c1D45B TEX-I\"></mjx-c></mjx-mi><mjx-texatom texclass=\"ORD\"><mjx-mi class=\"mjx-ds mjx-b\"><mjx-c class=\"mjx-c2124 TEX-A\"></mjx-c></mjx-mi></mjx-texatom></mjx-math></mjx-container>.</p>","style":"\nmjx-container[jax=\"CHTML\"] {\n  line-height: 0;\n}\n\nmjx-container [space=\"1\"] {\n  margin-left: .111em;\n}\n\nmjx-container [space=\"2\"] {\n  margin-left: .167em;\n}\n\nmjx-container [space=\"3\"] {\n  margin-left: .222em;\n}\n\nmjx-container [space=\"4\"] {\n  margin-left: .278em;\n}\n\nmjx-container [space=\"5\"] {\n  margin-left: .333em;\n}\n\nmjx-container [rspace=\"1\"] {\n  margin-right: .111em;\n}\n\nmjx-container [rspace=\"2\"] {\n  margin-right: .167em;\n}\n\nmjx-container [rspace=\"3\"] {\n  margin-right: .222em;\n}\n\nmjx-container [rspace=\"4\"] {\n  margin-right: .278em;\n}\n\nmjx-container [rspace=\"5\"] {\n  margin-right: .333em;\n}\n\nmjx-container [size=\"s\"] {\n  font-size: 70.7%;\n}\n\nmjx-container [size=\"ss\"] {\n  font-size: 50%;\n}\n\nmjx-container [size=\"Tn\"] {\n  font-size: 60%;\n}\n\nmjx-container [size=\"sm\"] {\n  font-size: 85%;\n}\n\nmjx-container [size=\"lg\"] {\n  font-size: 120%;\n}\n\nmjx-container [size=\"Lg\"] {\n  font-size: 144%;\n}\n\nmjx-container [size=\"LG\"] {\n  font-size: 173%;\n}\n\nmjx-container [size=\"hg\"] {\n  font-size: 207%;\n}\n\nmjx-container [size=\"HG\"] {\n  font-size: 249%;\n}\n\nmjx-container [width=\"full\"] {\n  width: 100%;\n}\n\nmjx-box {\n  display: inline-block;\n}\n\nmjx-block {\n  display: block;\n}\n\nmjx-itable {\n  display: inline-table;\n}\n\nmjx-row {\n  display: table-row;\n}\n\nmjx-row > * {\n  display: table-cell;\n}\n\nmjx-mtext {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-mstyle {\n  display: inline-block;\n}\n\nmjx-merror {\n  display: inline-block;\n  color: red;\n  background-color: yellow;\n}\n\nmjx-mphantom {\n  visibility: hidden;\n}\n\n_::-webkit-full-page-media, _:future, :root mjx-container {\n  will-change: opacity;\n}\n\nmjx-math {\n  display: inline-block;\n  text-align: left;\n  line-height: 0;\n  text-indent: 0;\n  font-style: normal;\n  font-weight: normal;\n  font-size: 100%;\n  font-size-adjust: none;\n  letter-spacing: normal;\n  border-collapse: collapse;\n  word-wrap: normal;\n  word-spacing: normal;\n  white-space: nowrap;\n  direction: ltr;\n  padding: 1px 0;\n}\n\nmjx-container[jax=\"CHTML\"][display=\"true\"] {\n  display: block;\n  text-align: center;\n  margin: 1em 0;\n}\n\nmjx-container[jax=\"CHTML\"][display=\"true\"][width=\"full\"] {\n  display: flex;\n}\n\nmjx-container[jax=\"CHTML\"][display=\"true\"] mjx-math {\n  padding: 0;\n}\n\nmjx-container[jax=\"CHTML\"][justify=\"left\"] {\n  text-align: left;\n}\n\nmjx-container[jax=\"CHTML\"][justify=\"right\"] {\n  text-align: right;\n}\n\nmjx-mi {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-c {\n  display: inline-block;\n}\n\nmjx-utext {\n  display: inline-block;\n  padding: .75em 0 .2em 0;\n}\n\nmjx-mo {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-stretchy-h {\n  display: inline-table;\n  width: 100%;\n}\n\nmjx-stretchy-h > * {\n  display: table-cell;\n  width: 0;\n}\n\nmjx-stretchy-h > * > mjx-c {\n  display: inline-block;\n  transform: scalex(1.0000001);\n}\n\nmjx-stretchy-h > * > mjx-c::before {\n  display: inline-block;\n  width: initial;\n}\n\nmjx-stretchy-h > mjx-ext {\n  /* IE */ overflow: hidden;\n  /* others */ overflow: clip visible;\n  width: 100%;\n}\n\nmjx-stretchy-h > mjx-ext > mjx-c::before {\n  transform: scalex(500);\n}\n\nmjx-stretchy-h > mjx-ext > mjx-c {\n  width: 0;\n}\n\nmjx-stretchy-h > mjx-beg > mjx-c {\n  margin-right: -.1em;\n}\n\nmjx-stretchy-h > mjx-end > mjx-c {\n  margin-left: -.1em;\n}\n\nmjx-stretchy-v {\n  display: inline-block;\n}\n\nmjx-stretchy-v > * {\n  display: block;\n}\n\nmjx-stretchy-v > mjx-beg {\n  height: 0;\n}\n\nmjx-stretchy-v > mjx-end > mjx-c {\n  display: block;\n}\n\nmjx-stretchy-v > * > mjx-c {\n  transform: scaley(1.0000001);\n  transform-origin: left center;\n  overflow: hidden;\n}\n\nmjx-stretchy-v > mjx-ext {\n  display: block;\n  height: 100%;\n  box-sizing: border-box;\n  border: 0px solid transparent;\n  /* IE */ overflow: hidden;\n  /* others */ overflow: visible clip;\n}\n\nmjx-stretchy-v > mjx-ext > mjx-c::before {\n  width: initial;\n  box-sizing: border-box;\n}\n\nmjx-stretchy-v > mjx-ext > mjx-c {\n  transform: scaleY(500) translateY(.075em);\n  overflow: visible;\n}\n\nmjx-mark {\n  display: inline-block;\n  height: 0px;\n}\n\nmjx-mn {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-msup {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-mrow {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-mtable {\n  display: inline-block;\n  text-align: center;\n  vertical-align: .25em;\n  position: relative;\n  box-sizing: border-box;\n  border-spacing: 0;\n  border-collapse: collapse;\n}\n\nmjx-mstyle[size=\"s\"] mjx-mtable {\n  vertical-align: .354em;\n}\n\nmjx-labels {\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n\nmjx-table {\n  display: inline-block;\n  vertical-align: -.5ex;\n  box-sizing: border-box;\n}\n\nmjx-table > mjx-itable {\n  vertical-align: middle;\n  text-align: left;\n  box-sizing: border-box;\n}\n\nmjx-labels > mjx-itable {\n  position: absolute;\n  top: 0;\n}\n\nmjx-mtable[justify=\"left\"] {\n  text-align: left;\n}\n\nmjx-mtable[justify=\"right\"] {\n  text-align: right;\n}\n\nmjx-mtable[justify=\"left\"][side=\"left\"] {\n  padding-right: 0 ! important;\n}\n\nmjx-mtable[justify=\"left\"][side=\"right\"] {\n  padding-left: 0 ! important;\n}\n\nmjx-mtable[justify=\"right\"][side=\"left\"] {\n  padding-right: 0 ! important;\n}\n\nmjx-mtable[justify=\"right\"][side=\"right\"] {\n  padding-left: 0 ! important;\n}\n\nmjx-mtable[align] {\n  vertical-align: baseline;\n}\n\nmjx-mtable[align=\"top\"] > mjx-table {\n  vertical-align: top;\n}\n\nmjx-mtable[align=\"bottom\"] > mjx-table {\n  vertical-align: bottom;\n}\n\nmjx-mtable[side=\"right\"] mjx-labels {\n  min-width: 100%;\n}\n\nmjx-mtr {\n  display: table-row;\n  text-align: left;\n}\n\nmjx-mtr[rowalign=\"top\"] > mjx-mtd {\n  vertical-align: top;\n}\n\nmjx-mtr[rowalign=\"center\"] > mjx-mtd {\n  vertical-align: middle;\n}\n\nmjx-mtr[rowalign=\"bottom\"] > mjx-mtd {\n  vertical-align: bottom;\n}\n\nmjx-mtr[rowalign=\"baseline\"] > mjx-mtd {\n  vertical-align: baseline;\n}\n\nmjx-mtr[rowalign=\"axis\"] > mjx-mtd {\n  vertical-align: .25em;\n}\n\nmjx-mtd {\n  display: table-cell;\n  text-align: center;\n  padding: .215em .4em;\n}\n\nmjx-mtd:first-child {\n  padding-left: 0;\n}\n\nmjx-mtd:last-child {\n  padding-right: 0;\n}\n\nmjx-mtable > * > mjx-itable > *:first-child > mjx-mtd {\n  padding-top: 0;\n}\n\nmjx-mtable > * > mjx-itable > *:last-child > mjx-mtd {\n  padding-bottom: 0;\n}\n\nmjx-tstrut {\n  display: inline-block;\n  height: 1em;\n  vertical-align: -.25em;\n}\n\nmjx-labels[align=\"left\"] > mjx-mtr > mjx-mtd {\n  text-align: left;\n}\n\nmjx-labels[align=\"right\"] > mjx-mtr > mjx-mtd {\n  text-align: right;\n}\n\nmjx-mtd[extra] {\n  padding: 0;\n}\n\nmjx-mtd[rowalign=\"top\"] {\n  vertical-align: top;\n}\n\nmjx-mtd[rowalign=\"center\"] {\n  vertical-align: middle;\n}\n\nmjx-mtd[rowalign=\"bottom\"] {\n  vertical-align: bottom;\n}\n\nmjx-mtd[rowalign=\"baseline\"] {\n  vertical-align: baseline;\n}\n\nmjx-mtd[rowalign=\"axis\"] {\n  vertical-align: .25em;\n}\n\nmjx-msub {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-TeXAtom {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-mover {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-mover:not([limits=\"false\"]) {\n  padding-top: .1em;\n}\n\nmjx-mover:not([limits=\"false\"]) > * {\n  display: block;\n  text-align: left;\n}\n\nmjx-mspace {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-msubsup {\n  display: inline-block;\n  text-align: left;\n}\n\nmjx-script {\n  display: inline-block;\n  padding-right: .05em;\n  padding-left: .033em;\n}\n\nmjx-script > mjx-spacer {\n  display: block;\n}\n\nmjx-c::before {\n  display: block;\n  width: 0;\n}\n\n.MJX-TEX {\n  font-family: MJXZERO, MJXTEX;\n}\n\n.TEX-B {\n  font-family: MJXZERO, MJXTEX-B;\n}\n\n.TEX-I {\n  font-family: MJXZERO, MJXTEX-I;\n}\n\n.TEX-MI {\n  font-family: MJXZERO, MJXTEX-MI;\n}\n\n.TEX-BI {\n  font-family: MJXZERO, MJXTEX-BI;\n}\n\n.TEX-S1 {\n  font-family: MJXZERO, MJXTEX-S1;\n}\n\n.TEX-S2 {\n  font-family: MJXZERO, MJXTEX-S2;\n}\n\n.TEX-S3 {\n  font-family: MJXZERO, MJXTEX-S3;\n}\n\n.TEX-S4 {\n  font-family: MJXZERO, MJXTEX-S4;\n}\n\n.TEX-A {\n  font-family: MJXZERO, MJXTEX-A;\n}\n\n.TEX-C {\n  font-family: MJXZERO, MJXTEX-C;\n}\n\n.TEX-CB {\n  font-family: MJXZERO, MJXTEX-CB;\n}\n\n.TEX-FR {\n  font-family: MJXZERO, MJXTEX-FR;\n}\n\n.TEX-FRB {\n  font-family: MJXZERO, MJXTEX-FRB;\n}\n\n.TEX-SS {\n  font-family: MJXZERO, MJXTEX-SS;\n}\n\n.TEX-SSB {\n  font-family: MJXZERO, MJXTEX-SSB;\n}\n\n.TEX-SSI {\n  font-family: MJXZERO, MJXTEX-SSI;\n}\n\n.TEX-SC {\n  font-family: MJXZERO, MJXTEX-SC;\n}\n\n.TEX-T {\n  font-family: MJXZERO, MJXTEX-T;\n}\n\n.TEX-V {\n  font-family: MJXZERO, MJXTEX-V;\n}\n\n.TEX-VB {\n  font-family: MJXZERO, MJXTEX-VB;\n}\n\nmjx-stretchy-v mjx-c, mjx-stretchy-h mjx-c {\n  font-family: MJXZERO, MJXTEX-S1, MJXTEX-S4, MJXTEX, MJXTEX-A ! important;\n}\n\n@font-face /* 0 */ {\n  font-family: MJXZERO;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Zero.woff\") format(\"woff\");\n}\n\n@font-face /* 1 */ {\n  font-family: MJXTEX;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 2 */ {\n  font-family: MJXTEX-B;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff\") format(\"woff\");\n}\n\n@font-face /* 3 */ {\n  font-family: MJXTEX-I;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff\") format(\"woff\");\n}\n\n@font-face /* 4 */ {\n  font-family: MJXTEX-MI;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff\") format(\"woff\");\n}\n\n@font-face /* 5 */ {\n  font-family: MJXTEX-BI;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff\") format(\"woff\");\n}\n\n@font-face /* 6 */ {\n  font-family: MJXTEX-S1;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 7 */ {\n  font-family: MJXTEX-S2;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 8 */ {\n  font-family: MJXTEX-S3;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 9 */ {\n  font-family: MJXTEX-S4;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 10 */ {\n  font-family: MJXTEX-A;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 11 */ {\n  font-family: MJXTEX-C;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 12 */ {\n  font-family: MJXTEX-CB;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff\") format(\"woff\");\n}\n\n@font-face /* 13 */ {\n  font-family: MJXTEX-FR;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 14 */ {\n  font-family: MJXTEX-FRB;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff\") format(\"woff\");\n}\n\n@font-face /* 15 */ {\n  font-family: MJXTEX-SS;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 16 */ {\n  font-family: MJXTEX-SSB;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff\") format(\"woff\");\n}\n\n@font-face /* 17 */ {\n  font-family: MJXTEX-SSI;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff\") format(\"woff\");\n}\n\n@font-face /* 18 */ {\n  font-family: MJXTEX-SC;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 19 */ {\n  font-family: MJXTEX-T;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 20 */ {\n  font-family: MJXTEX-V;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff\") format(\"woff\");\n}\n\n@font-face /* 21 */ {\n  font-family: MJXTEX-VB;\n  src: url(\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff\") format(\"woff\");\n}\n\nmjx-stretchy-v.mjx-c5B mjx-beg mjx-c::before {\n  content: \"\\23A1\";\n  padding: 1.154em 0.667em 0.645em 0;\n}\n\nmjx-stretchy-v.mjx-c5B mjx-ext mjx-c::before {\n  content: \"\\23A2\";\n  width: 0.667em;\n}\n\nmjx-stretchy-v.mjx-c5B mjx-end mjx-c::before {\n  content: \"\\23A3\";\n  padding: 1.155em 0.667em 0.644em 0;\n}\n\nmjx-stretchy-v.mjx-c5B > mjx-end {\n  margin-top: -1.799em;\n}\n\nmjx-stretchy-v.mjx-c5B > mjx-ext {\n  border-top-width: 1.769em;\n  border-bottom-width: 1.769em;\n}\n\nmjx-stretchy-v.mjx-c5D mjx-beg mjx-c::before {\n  content: \"\\23A4\";\n  padding: 1.154em 0.667em 0.645em 0;\n}\n\nmjx-stretchy-v.mjx-c5D mjx-ext mjx-c::before {\n  content: \"\\23A5\";\n  width: 0.667em;\n}\n\nmjx-stretchy-v.mjx-c5D mjx-end mjx-c::before {\n  content: \"\\23A6\";\n  padding: 1.155em 0.667em 0.644em 0;\n}\n\nmjx-stretchy-v.mjx-c5D > mjx-end {\n  margin-top: -1.799em;\n}\n\nmjx-stretchy-v.mjx-c5D > mjx-ext {\n  border-top-width: 1.769em;\n  border-bottom-width: 1.769em;\n}\n\nmjx-c.mjx-c1D45D.TEX-I::before {\n  padding: 0.442em 0.503em 0.194em 0;\n  content: \"p\";\n}\n\nmjx-c.mjx-c28::before {\n  padding: 0.75em 0.389em 0.25em 0;\n  content: \"(\";\n}\n\nmjx-c.mjx-c1D465.TEX-I::before {\n  padding: 0.442em 0.572em 0.011em 0;\n  content: \"x\";\n}\n\nmjx-c.mjx-c29::before {\n  padding: 0.75em 0.389em 0.25em 0;\n  content: \")\";\n}\n\nmjx-c.mjx-c3D::before {\n  padding: 0.583em 0.778em 0.082em 0;\n  content: \"=\";\n}\n\nmjx-c.mjx-c31::before {\n  padding: 0.666em 0.5em 0 0;\n  content: \"1\";\n}\n\nmjx-c.mjx-c39::before {\n  padding: 0.666em 0.5em 0.022em 0;\n  content: \"9\";\n}\n\nmjx-c.mjx-c36::before {\n  padding: 0.666em 0.5em 0.022em 0;\n  content: \"6\";\n}\n\nmjx-c.mjx-c33::before {\n  padding: 0.665em 0.5em 0.022em 0;\n  content: \"3\";\n}\n\nmjx-c.mjx-c2B::before {\n  padding: 0.583em 0.778em 0.082em 0;\n  content: \"+\";\n}\n\nmjx-c.mjx-c34::before {\n  padding: 0.677em 0.5em 0 0;\n  content: \"4\";\n}\n\nmjx-c.mjx-c38::before {\n  padding: 0.666em 0.5em 0.022em 0;\n  content: \"8\";\n}\n\nmjx-c.mjx-c32::before {\n  padding: 0.666em 0.5em 0 0;\n  content: \"2\";\n}\n\nmjx-c.mjx-c37::before {\n  padding: 0.676em 0.5em 0.022em 0;\n  content: \"7\";\n}\n\nmjx-c.mjx-c35::before {\n  padding: 0.666em 0.5em 0.022em 0;\n  content: \"5\";\n}\n\nmjx-c.mjx-c1D45E.TEX-I::before {\n  padding: 0.442em 0.46em 0.194em 0;\n  content: \"q\";\n}\n\nmjx-c.mjx-c30::before {\n  padding: 0.666em 0.5em 0.022em 0;\n  content: \"0\";\n}\n\nmjx-c.mjx-c2E::before {\n  padding: 0.12em 0.278em 0 0;\n  content: \".\";\n}\n\nmjx-c.mjx-c5B.TEX-S3::before {\n  padding: 1.45em 0.528em 0.949em 0;\n  content: \"[\";\n}\n\nmjx-c.mjx-c5D.TEX-S3::before {\n  padding: 1.45em 0.528em 0.949em 0;\n  content: \"]\";\n}\n\nmjx-c.mjx-c1D44F.TEX-I::before {\n  padding: 0.694em 0.429em 0.011em 0;\n  content: \"b\";\n}\n\nmjx-c.mjx-c1D44E.TEX-I::before {\n  padding: 0.441em 0.529em 0.01em 0;\n  content: \"a\";\n}\n\nmjx-c.mjx-c21::before {\n  padding: 0.716em 0.278em 0 0;\n  content: \"!\";\n}\n\nmjx-c.mjx-c27F9::before {\n  padding: 0.525em 1.638em 0.024em 0;\n  content: \"\\27F9\";\n}\n\nmjx-c.mjx-c2212::before {\n  padding: 0.583em 0.778em 0.082em 0;\n  content: \"\\2212\";\n}\n\nmjx-c.mjx-c27E8::before {\n  padding: 0.75em 0.389em 0.25em 0;\n  content: \"\\27E8\";\n}\n\nmjx-c.mjx-c1D453.TEX-I::before {\n  padding: 0.705em 0.55em 0.205em 0;\n  content: \"f\";\n}\n\nmjx-c.mjx-c27E9::before {\n  padding: 0.75em 0.389em 0.25em 0;\n  content: \"\\27E9\";\n}\n\nmjx-c.mjx-c2C::before {\n  padding: 0.121em 0.278em 0.194em 0;\n  content: \",\";\n}\n\nmjx-c.mjx-c65::before {\n  padding: 0.448em 0.444em 0.011em 0;\n  content: \"e\";\n}\n\nmjx-c.mjx-c67::before {\n  padding: 0.453em 0.5em 0.206em 0;\n  content: \"g\";\n}\n\nmjx-c.mjx-cA0::before {\n  padding: 0 0.25em 0 0;\n  content: \"\\A0\";\n}\n\nmjx-c.mjx-c2295::before {\n  padding: 0.583em 0.778em 0.083em 0;\n  content: \"\\2295\";\n}\n\nmjx-c.mjx-c1D466.TEX-I::before {\n  padding: 0.442em 0.49em 0.205em 0;\n  content: \"y\";\n}\n\nmjx-c.mjx-c5B::before {\n  padding: 0.75em 0.278em 0.25em 0;\n  content: \"[\";\n}\n\nmjx-c.mjx-c2227::before {\n  padding: 0.598em 0.667em 0.022em 0;\n  content: \"\\2227\";\n}\n\nmjx-c.mjx-cAC::before {\n  padding: 0.356em 0.667em 0 0;\n  content: \"\\AC\";\n}\n\nmjx-c.mjx-c2228::before {\n  padding: 0.598em 0.667em 0.022em 0;\n  content: \"\\2228\";\n}\n\nmjx-c.mjx-c5D::before {\n  padding: 0.75em 0.278em 0.25em 0;\n  content: \"]\";\n}\n\nmjx-c.mjx-c22C5::before {\n  padding: 0.31em 0.278em 0 0;\n  content: \"\\22C5\";\n}\n\nmjx-c.mjx-c1D41A.TEX-B::before {\n  padding: 0.453em 0.559em 0.006em 0;\n  content: \"a\";\n}\n\nmjx-c.mjx-c1D45B.TEX-I::before {\n  padding: 0.442em 0.6em 0.011em 0;\n  content: \"n\";\n}\n\nmjx-c.mjx-c1D45A.TEX-I::before {\n  padding: 0.442em 0.878em 0.011em 0;\n  content: \"m\";\n}\n\nmjx-c.mjx-c2124.TEX-A::before {\n  padding: 0.683em 0.667em 0 0;\n  content: \"Z\";\n}\n\nmjx-c.mjx-c2F::before {\n  padding: 0.75em 0.5em 0.25em 0;\n  content: \"/\";\n}\n\nmjx-c.mjx-c3A::before {\n  padding: 0.43em 0.278em 0 0;\n  content: \":\";\n}\n\nmjx-c.mjx-c7B::before {\n  padding: 0.75em 0.5em 0.25em 0;\n  content: \"{\";\n}\n\nmjx-c.mjx-c7D::before {\n  padding: 0.75em 0.5em 0.25em 0;\n  content: \"}\";\n}\n\nmjx-c.mjx-c2192::before {\n  padding: 0.511em 1em 0.011em 0;\n  content: \"\\2192\";\n}\n\nmjx-c.mjx-c22EF::before {\n  padding: 0.31em 1.172em 0 0;\n  content: \"\\22EF\";\n}\n\nmjx-c.mjx-c1D451.TEX-I::before {\n  padding: 0.694em 0.52em 0.01em 0;\n  content: \"d\";\n}\n\nmjx-c.mjx-c2026::before {\n  padding: 0.12em 1.172em 0 0;\n  content: \"\\2026\";\n}\n\nmjx-c.mjx-c64::before {\n  padding: 0.694em 0.556em 0.011em 0;\n  content: \"d\";\n}\n\nmjx-c.mjx-c2061::before {\n  padding: 0 0 0 0;\n  content: \"\";\n}\n"}},"__N_SSG":true}